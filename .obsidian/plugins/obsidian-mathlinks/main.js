/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target, mod));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MathLinks
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  templates: [],
  excludedFilePaths: [],
  autoUpdate: true
};
var MathLinksSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    return __async(this, null, function* () {
      const { containerEl } = this;
      containerEl.empty();
      containerEl.createEl("h2", { text: "MathLinks Settings" });
      new import_obsidian.Setting(containerEl).setName("Update when modified").setDesc("Automatically update links in the current file when modified.").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.autoUpdate).onChange((current) => __async(this, null, function* () {
          this.plugin.settings.autoUpdate = current;
          yield this.plugin.saveSettings();
        }));
      });
      new import_obsidian.Setting(containerEl).setName("Add a new template").setDesc(createFragment((e) => {
        e.createSpan({ text: "Generate mathLinks with a new template. Use " });
        e.createEl("code", { text: "mathLink: auto" });
        e.createSpan({ text: " to use templates in a file." });
      })).addButton((button) => {
        let b = button.setTooltip("Add").setIcon("plus").onClick(() => __async(this, null, function* () {
          let modal = new AddTemplatesModal(this.app);
          modal.onClose = () => __async(this, null, function* () {
            if (modal.saved) {
              const template = {
                title: modal.title,
                replaced: modal.replaced,
                replacement: modal.replacement,
                globalMatch: modal.globalMatch,
                sensitive: modal.sensitive,
                word: modal.word
              };
              this.plugin.settings.templates.push(template);
              yield this.plugin.saveSettings();
              this.plugin.updateAutoNotes();
              new import_obsidian.Notice("MathLinks: Template added");
            }
          });
          modal.open();
          this.display();
        }));
        return b;
      });
      let templateTitle;
      new import_obsidian.Setting(containerEl).setName("Edit/delete template").setDesc("Select a template to edit/delete it.").addDropdown((dropdown) => {
        dropdown.addOption("__select", "Select");
        this.plugin.settings.templates.forEach((template) => {
          dropdown.addOption(template.title, template.title);
        });
        dropdown.onChange((current) => __async(this, null, function* () {
          if (current != "__select")
            templateTitle = current;
          else
            templateTitle = null;
        }));
      }).addExtraButton((button) => {
        let b = button.setTooltip("Edit").setIcon("edit").onClick(() => __async(this, null, function* () {
          if (templateTitle) {
            let originalTemplates = JSON.parse(JSON.stringify(this.plugin.settings.templates));
            let modal = new EditTemplatesModal(this.app, templateTitle, this.plugin.settings.templates);
            modal.onClose = () => __async(this, null, function* () {
              if (modal.saved) {
                yield this.plugin.saveSettings();
                this.plugin.updateAutoNotes();
                new import_obsidian.Notice("MathLinks: Template saved");
              } else {
                this.plugin.settings.templates = originalTemplates;
              }
            });
            modal.open();
            this.display();
          } else {
            new import_obsidian.Notice("MathLinks: Please select a template");
          }
        }));
        return b;
      }).addExtraButton((button) => {
        let b = button.setTooltip("Delete").setIcon("trash").onClick(() => __async(this, null, function* () {
          if (templateTitle) {
            let modal = new DeleteModal(this.app, `Are you sure you want to delete '${templateTitle}'?`);
            modal.onClose = () => __async(this, null, function* () {
              if (modal.saved) {
                for (let i = 0; i < this.plugin.settings.templates.length; i++) {
                  if (this.plugin.settings.templates[i].title === templateTitle) {
                    this.plugin.settings.templates.splice(i, 1);
                    yield this.plugin.saveSettings();
                    new import_obsidian.Notice(`MathLinks: Template '${templateTitle}' deleted`);
                    break;
                  }
                }
              }
            });
            modal.open();
            this.display();
          } else {
            new import_obsidian.Notice("MathLinks: Please select a template");
          }
        }));
        return b;
      });
      new import_obsidian.Setting(containerEl).setName("Add an excluded file").setDesc("MathLinks will ignore those files.").addButton((button) => {
        let b = button.setTooltip("Add").setIcon("plus").onClick(() => __async(this, null, function* () {
          let modal = new AddExcludedModal(this.app);
          modal.onClose = () => __async(this, null, function* () {
            if (modal.saved) {
              const excludedFilePath2 = {
                path: modal.excludedFilePath,
                isFile: modal.isFile
              };
              this.plugin.settings.excludedFilePaths.push(excludedFilePath2);
              yield this.plugin.saveSettings();
              if (modal.isFile)
                new import_obsidian.Notice("MathLinks: File excluded");
              else
                new import_obsidian.Notice("MathLinks: Path exclcuded");
            }
          });
          modal.open();
          this.display();
        }));
        return b;
      });
      let excludedFilePath;
      new import_obsidian.Setting(containerEl).setName("Remove from excluded files").setDesc("Remove a file from the list of excluded files.").addDropdown((dropdown) => __async(this, null, function* () {
        dropdown.addOption("__select", "Select");
        this.plugin.settings.excludedFilePaths.forEach((excludedFilePath2) => {
          dropdown.addOption(excludedFilePath2.path, excludedFilePath2.path);
        });
        dropdown.onChange((current) => __async(this, null, function* () {
          if (current != "__select")
            excludedFilePath = current;
          else
            excludedFilePath = null;
        }));
      })).addExtraButton((button) => {
        let b = button.setTooltip("Remove").setIcon("trash").onClick(() => __async(this, null, function* () {
          if (excludedFilePath) {
            let modal = new DeleteModal(this.app, `Are you sure you want to remove '${excludedFilePath}' from the list of excluded files/paths?`);
            modal.onClose = () => __async(this, null, function* () {
              if (modal.saved) {
                for (let i = 0; i < this.plugin.settings.excludedFilePaths.length; i++) {
                  if (this.plugin.settings.excludedFilePaths[i].path === excludedFilePath) {
                    this.plugin.settings.excludedFilePaths.splice(i, 1);
                    yield this.plugin.saveSettings();
                    new import_obsidian.Notice(`MathLinks: '${excludedFilePath}' removed from excluded files`);
                    break;
                  }
                }
              }
            });
            modal.open();
            this.display();
          } else {
            new import_obsidian.Notice("MathLinks: Please select a file");
          }
        }));
        return b;
      });
    });
  }
};
var AddTemplatesModal = class extends import_obsidian.Modal {
  constructor(app2) {
    super(app2);
    this.saved = false;
    this.proceed = false;
    this.title = "";
    this.replaced = "";
    this.replacement = "";
    this.globalMatch = true;
    this.sensitive = true;
    this.word = true;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    loadTemplateSettings(contentEl, this);
    loadButtonsToClose(this, this.contentEl.createDiv(), true, "Add", "checkmark", "Cancel", "cross");
  }
};
var EditTemplatesModal = class extends import_obsidian.Modal {
  constructor(app2, templateTitle, templates) {
    super(app2);
    this.saved = false;
    this.proceed = false;
    this.templateTitle = templateTitle;
    this.templates = templates;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    this.templates.every((template) => {
      if (this.templateTitle != void 0 && template.title == this.templateTitle) {
        loadTemplateSettings(contentEl, template);
        return false;
      }
      return true;
    });
    loadButtonsToClose(this, this.contentEl.createDiv(), true, "Save", "checkmark", "Cancel", "cross");
  }
};
var AddExcludedModal = class extends import_obsidian.Modal {
  constructor(app2) {
    super(app2);
    this.saved = false;
    this.proceed = false;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    let excludedFilePathText;
    new import_obsidian.Setting(contentEl).setName("File name/path of folder").setDesc(createFragment((e) => {
      e.createSpan({ text: "Enter a file as" });
      e.createEl("code", { text: "path/name.md" });
      e.createSpan({ text: " and a folder as " });
      e.createEl("code", { text: "path" });
      e.createSpan({ text: "." });
    })).addText((text) => {
      excludedFilePathText = text;
      let footerEl = this.contentEl.createDiv();
      loadButtonsToClose(this, footerEl, this.proceed, "Add", "checkmark", "Cancel", "cross");
      excludedFilePathText.setValue(excludedFilePathText).onChange((current) => {
        let file = app.vault.getAbstractFileByPath(current);
        if (file != null) {
          this.excludedFilePath = file.path;
          this.isFile = file instanceof import_obsidian.TFile;
          this.proceed = true;
        } else {
          this.proceed = false;
        }
        footerEl.empty();
        loadButtonsToClose(this, footerEl, this.proceed, "Add", "checkmark", "Cancel", "cross");
      });
    });
  }
};
var DeleteModal = class extends import_obsidian.Modal {
  constructor(app2, areYouSure) {
    super(app2);
    this.saved = false;
    this.proceed = false;
    this.areYouSure = areYouSure;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: this.areYouSure });
    loadButtonsToClose(this, this.contentEl.createDiv(), true, "Yes", "checkmark", "No", "cross");
  }
};
function loadTemplateSettings(contentEl, template) {
  let titleText;
  new import_obsidian.Setting(contentEl).setName("Title").setDesc("Name of the template.").addText((text) => {
    titleText = text;
    titleText.setValue(template.title).onChange((current) => {
      template.title = current;
    });
  });
  let replacedText;
  new import_obsidian.Setting(contentEl).setName("Match for...").setDesc("String to be matched and replaced. Do not include regex.").addText((text) => {
    replacedText = text;
    replacedText.setValue(template.replaced).onChange((current) => {
      template.replaced = current;
    });
  });
  let replacementText;
  new import_obsidian.Setting(contentEl).setName("Replace with...").setDesc("String to replace matches. Do not escape backslashes.").addText((text) => {
    replacementText = text;
    replacementText.setValue(template.replacement).onChange((current) => {
      template.replacement = current;
    });
  });
  new import_obsidian.Setting(contentEl).setName("Global match").setDesc("Match all instances (instead of just the first).").addToggle((toggle) => {
    toggle.setValue(template.globalMatch).onChange((current) => template.globalMatch = current);
  });
  new import_obsidian.Setting(contentEl).setName("Case sensitive").setDesc("Matches will be case sensitive.").addToggle((toggle) => {
    toggle.setValue(template.sensitive).onChange((current) => template.sensitive = current);
  });
  new import_obsidian.Setting(contentEl).setName("Match whole words").setDesc("Only match whole words.").addToggle((toggle) => {
    toggle.setValue(template.word).onChange((current) => template.word = current);
  });
}
function loadButtonsToClose(modal, element, proceed, trueToolTip, trueIcon, falseToolTip, falseIcon) {
  let footerButtons = new import_obsidian.Setting(element);
  footerButtons.addButton((b) => {
    b.setTooltip(trueToolTip).setIcon(trueIcon).onClick(() => __async(this, null, function* () {
      if (!proceed) {
        new import_obsidian.Notice("MathLinks: Please enter a valid path/file");
      } else {
        modal.saved = true;
        modal.close();
      }
    }));
  });
  footerButtons.addExtraButton((b) => {
    b.setTooltip(falseToolTip).setIcon(falseIcon).onClick(() => __async(this, null, function* () {
      modal.saved = false;
      modal.close();
    }));
  });
}

// src/utils.ts
function formatRegex(str) {
  return str.replace(/\s/g, "\\s").replace(/\./g, "\\.").replace(/\(/g, "\\(").replace(/\)/g, "\\)").replace(/\{/g, "\\{").replace(/\}/g, "\\}").replace(/\[/g, "\\[").replace(/\]/g, "\\]");
}
function isExcluded(file, excludedFilePaths) {
  for (let i = 0; i < excludedFilePaths.length; i++) {
    let path = excludedFilePaths[i];
    if (path.isFile && file.path === path.path) {
      return true;
    } else if (!path.isFile) {
      let pathRegex = new RegExp(`\\b${path.path}/`);
      if (pathRegex.test(file.path))
        return true;
    }
  }
  return false;
}
function getIncludedNotes(allNotes, excludedFilePaths) {
  let allIncludedNotes = [];
  allNotes.forEach((note) => {
    if (!isExcluded(note, excludedFilePaths))
      allIncludedNotes.push(note);
  });
  return allIncludedNotes;
}

// src/main.ts
var fs = __toESM(require("fs"));
var MathLinks = class extends import_obsidian2.Plugin {
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      this.addSettingTab(new MathLinksSettingTab(this.app, this));
      const settings = this.settings;
      this.app.metadataCache.on("changed", (file, data, cache) => __async(this, null, function* () {
        if (!settings.autoUpdate || isExcluded(file, settings.excludedFilePaths))
          return null;
        let mathLink = yield this.getMathLink(file);
        if (mathLink != null && mathLink != void 0)
          this.updateBackLinks(file, mathLink[0]);
        else
          this.removeBackMathLinks(file);
        this.updateOutLinks(file);
      }));
      this.addCommand({
        id: "update_all_mathlinks",
        name: "Update all links",
        callback: () => __async(this, null, function* () {
          let allNotes = yield this.app.vault.getMarkdownFiles();
          let allIncludedNotes = getIncludedNotes(allNotes, settings.excludedFilePaths);
          let updateNotice = new Notice("MathLinks: Updating...");
          let count = 0;
          allIncludedNotes.forEach((note) => __async(this, null, function* () {
            let mathLink = yield this.getMathLink(note);
            if (mathLink != null && mathLink != void 0)
              this.updateBackLinks(note, mathLink[0]);
            else
              this.removeBackMathLinks(note);
            count++;
            updateNotice.setMessage(`MathLinks: Updating... ${count}/${allIncludedNotes.length}`);
            if (count === allIncludedNotes.length) {
              updateNotice.hide();
              new Notice("MathLinks: Updated all links");
            }
          }));
        })
      });
    });
  }
  getMathLink(file) {
    return __async(this, null, function* () {
      let contents = yield this.app.vault.read(file);
      contents = contents.split(/\r?\n/);
      if (contents[0] === "---") {
        for (let lineNumber = 1; lineNumber < contents.length; lineNumber++) {
          let line = contents[lineNumber];
          if (line.length < 10) {
            lineNumber++;
          } else {
            let key = line.substring(0, 10);
            if (key === "mathLink: ") {
              let value = line.replace(key, "");
              if (value != "") {
                if (value === "auto") {
                  let mathLink = yield this.generateMathLinkFromAuto(file);
                  return [mathLink, true];
                }
                return [value, false];
              } else {
                return null;
              }
            } else if (line === "---") {
              return void 0;
            } else {
              lineNumber++;
            }
          }
        }
      }
      return void 0;
    });
  }
  generateMathLinkFromAuto(file) {
    return __async(this, null, function* () {
      let templates = this.settings.templates;
      let mathLink = file.name.replace(".md", "");
      for (let i = 0; i < templates.length; i++) {
        let replaced = new RegExp(formatRegex(templates[i].replaced));
        let replacement = templates[i].replacement;
        let flags = "";
        if (templates[i].globalMatch)
          flags += "g";
        if (!templates[i].sensitive)
          flags += "i";
        if (templates[i].word)
          replaced = RegExp(replaced.source.replace(/^/, "\\b").replace(/$/, "\\b"), flags);
        else
          replaced = RegExp(replaced.source, flags);
        mathLink = mathLink.replace(replaced, replacement);
      }
      return mathLink;
    });
  }
  updateBackLinks(file, mathLink) {
    return __async(this, null, function* () {
      let backLinkFilePaths = this.getBackLinkFilePaths(file);
      if (backLinkFilePaths.length != 0) {
        backLinkFilePaths.forEach((backLinkFilePath) => __async(this, null, function* () {
          let backLinkFile = this.app.vault.getAbstractFileByPath(backLinkFilePath);
          if (backLinkFile instanceof import_obsidian2.TFile) {
            let backLinkFileContent = yield this.app.vault.read(backLinkFile);
            let modified = this.convertToMathLinks(file.name, backLinkFileContent, mathLink);
            if (backLinkFileContent != modified)
              this.app.vault.modify(backLinkFile, modified);
          }
        }));
      }
    });
  }
  removeBackMathLinks(file) {
    return __async(this, null, function* () {
      let backLinkFilePaths = this.getBackLinkFilePaths(file);
      if (backLinkFilePaths.length != 0) {
        backLinkFilePaths.forEach((backLinkFilePath) => __async(this, null, function* () {
          let backLinkFile = this.app.vault.getAbstractFileByPath(backLinkFilePath);
          if (backLinkFile instanceof import_obsidian2.TFile) {
            let backLinkFileContent = yield this.app.vault.read(backLinkFile);
            let vaultPath = this.app.vault.getRoot().vault.adapter.basePath;
            let configDir = this.app.vault.configDir;
            let modified = "";
            let obsidianConfigFile = yield fs.readFile(`${vaultPath}/${configDir}/app.json`, "utf8", (err, data) => {
              if (JSON.parse(data).useMarkdownLinks)
                modified = this.convertToMarkdownLinks(file.name, backLinkFileContent);
              else
                modified = this.convertToDoubleLinks(file.name, backLinkFileContent);
              if (backLinkFileContent != modified)
                this.app.vault.modify(backLinkFile, modified);
            });
          }
        }));
      }
    });
  }
  updateOutLinks(file) {
    return __async(this, null, function* () {
      let fileContent = yield this.app.vault.read(file);
      let modified = fileContent;
      let count = 0;
      let outLinks = yield this.app.metadataCache.getFileCache(file).links;
      if (outLinks != void 0) {
        outLinks.forEach((outLink) => __async(this, null, function* () {
          let outLinkFileName = outLink.link;
          if (outLink.displayText != "")
            outLinkFileName = outLinkFileName.replace(/$/, ".md");
          let outLinkFilePath = this.app.fileManager.getNewFileParent(outLinkFileName).path + "/" + outLinkFileName;
          let outLinkFile = this.app.vault.getAbstractFileByPath(outLinkFilePath);
          if (outLinkFile instanceof import_obsidian2.TFile) {
            let outLinkMathLink = yield this.getMathLink(outLinkFile);
            if (outLinkMathLink != null && outLinkMathLink != void 0)
              modified = this.convertToMathLinks(outLinkFileName, modified, outLinkMathLink[0]);
          }
          count++;
          if (count === outLinks.length && fileContent != modified)
            yield this.app.vault.modify(file, modified);
        }));
      }
    });
  }
  updateAutoNotes() {
    return __async(this, null, function* () {
      let allNotes = yield this.app.vault.getMarkdownFiles();
      let allIncludedNotes = getIncludedNotes(allNotes, this.settings.excludedFilePaths);
      allIncludedNotes.forEach((note) => __async(this, null, function* () {
        let mathLink = yield this.getMathLink(note);
        if (mathLink != null && mathLink != void 0 && mathLink[1])
          this.updateBackLinks(note, mathLink[0]);
        else
          this.removeBackMathLinks(note);
      }));
    });
  }
  getBackLinkFilePaths(file) {
    let backLinkFilePaths = [];
    Object.keys(this.app.metadataCache.resolvedLinks).forEach((key) => {
      let links = this.app.metadataCache.resolvedLinks[key];
      Object.keys(links).forEach((link) => {
        if (link === file.path)
          backLinkFilePaths.push(key);
      });
    });
    return backLinkFilePaths;
  }
  convertToMathLinks(fileName, fileContent, mathLink) {
    let left = mathLink.replace(/^/, "[").replace(/$/, "]");
    let right = fileName.replace(/^/, "(").replace(/$/, ")").replace(/\s/g, "%20");
    let newLink = `${left}${right}`;
    let mixedLink = new RegExp("\\[((?!\\]\\(|\\]\\]).)*\\]" + formatRegex(right), "g");
    let doubleLink = new RegExp(formatRegex(fileName.replace(/^/, "[[").replace(/\.md$/, "]]")), "g");
    return fileContent.replace(mixedLink, newLink).replace(doubleLink, newLink);
  }
  convertToDoubleLinks(fileName, fileContent) {
    let formattedName = fileName.replace(/^/, "(").replace(/$/, ")").replace(/\s/g, "%20");
    let mixedLink = new RegExp("\\[((?!\\]\\(|\\]\\]).)*\\]" + formatRegex(formattedName), "g");
    let doubleLink = fileName.replace(/^/, "[[").replace(/\.md$/, "]]");
    return fileContent.replace(mixedLink, doubleLink);
  }
  convertToMarkdownLinks(fileName, fileContent) {
    let formattedName = fileName.replace(/^/, "(").replace(/$/, ")").replace(/\s/g, "%20");
    let mixedLink = new RegExp("\\[((?!\\]\\(|\\]\\]).)*\\]" + formatRegex(formattedName), "g");
    let markdownLink = fileName.replace(/^/, "[").replace(/\.md$/, `]${formattedName}`);
    return fileContent.replace(mixedLink, markdownLink);
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91dGlscy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTWF0aExpbmtzU2V0dGluZ3MsIE1hdGhMaW5rc1NldHRpbmdUYWIsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICcuL3NldHRpbmdzJztcbmltcG9ydCB7IGZvcm1hdFJlZ2V4LCBpc0V4Y2x1ZGVkLCBnZXRJbmNsdWRlZE5vdGVzIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hdGhMaW5rcyBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IE1hdGhMaW5rc1NldHRpbmdzO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IE1hdGhMaW5rc1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzO1xuXG4gICAgICAgIHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2NoYW5nZWQnLCBhc3luYyAoZmlsZTogVEZpbGUsIGRhdGE6IHN0cmluZywgY2FjaGU6IENhY2hlZE1ldGFEYXRhKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXNldHRpbmdzLmF1dG9VcGRhdGUgfHwgaXNFeGNsdWRlZChmaWxlLCBzZXR0aW5ncy5leGNsdWRlZEZpbGVQYXRocykpXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGxldCBtYXRoTGluayA9IGF3YWl0IHRoaXMuZ2V0TWF0aExpbmsoZmlsZSk7XG4gICAgICAgICAgICBpZiAobWF0aExpbmsgIT0gbnVsbCAmJiBtYXRoTGluayAhPSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVCYWNrTGlua3MoZmlsZSwgbWF0aExpbmtbMF0pO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQmFja01hdGhMaW5rcyhmaWxlKTtcblxuICAgICAgICAgICAgdGhpcy51cGRhdGVPdXRMaW5rcyhmaWxlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInVwZGF0ZV9hbGxfbWF0aGxpbmtzXCIsXG4gICAgICAgICAgICBuYW1lOiBcIlVwZGF0ZSBhbGwgbGlua3NcIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGFsbE5vdGVzID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICAgICAgICAgIGxldCBhbGxJbmNsdWRlZE5vdGVzID0gZ2V0SW5jbHVkZWROb3RlcyhhbGxOb3Rlcywgc2V0dGluZ3MuZXhjbHVkZWRGaWxlUGF0aHMpO1xuICAgICAgICAgICAgICAgIGxldCB1cGRhdGVOb3RpY2UgPSBuZXcgTm90aWNlKCdNYXRoTGlua3M6IFVwZGF0aW5nLi4uJyk7XG5cbiAgICAgICAgICAgICAgICBsZXQgY291bnQgPSAwO1xuICAgICAgICAgICAgICAgIGFsbEluY2x1ZGVkTm90ZXMuZm9yRWFjaChhc3luYyAobm90ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbWF0aExpbmsgPSBhd2FpdCB0aGlzLmdldE1hdGhMaW5rKG5vdGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWF0aExpbmsgIT0gbnVsbCAmJiBtYXRoTGluayAhPSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUJhY2tMaW5rcyhub3RlLCBtYXRoTGlua1swXSk7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQmFja01hdGhMaW5rcyhub3RlKTtcblxuICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVOb3RpY2Uuc2V0TWVzc2FnZShgTWF0aExpbmtzOiBVcGRhdGluZy4uLiAke2NvdW50fS8ke2FsbEluY2x1ZGVkTm90ZXMubGVuZ3RofWApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQgPT09IGFsbEluY2x1ZGVkTm90ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVOb3RpY2UuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnTWF0aExpbmtzOiBVcGRhdGVkIGFsbCBsaW5rcycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGFzeW5jIGdldE1hdGhMaW5rKGZpbGU6IFRGaWxlKTogW3N0cmluZywgYm9vbGVhbl0gfCBudWxsIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgbGV0IGNvbnRlbnRzID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgY29udGVudHMgPSBjb250ZW50cy5zcGxpdCgvXFxyP1xcbi8pO1xuXG4gICAgICAgIGlmIChjb250ZW50c1swXSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGxpbmVOdW1iZXIgPSAxOyBsaW5lTnVtYmVyIDwgY29udGVudHMubGVuZ3RoOyBsaW5lTnVtYmVyKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgbGluZSA9IGNvbnRlbnRzW2xpbmVOdW1iZXJdO1xuICAgICAgICAgICAgICAgIGlmIChsaW5lLmxlbmd0aCA8IDEwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIrKztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gbGluZS5zdWJzdHJpbmcoMCwgMTApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAnbWF0aExpbms6ICcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IGxpbmUucmVwbGFjZShrZXksICcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtYXRoTGluayA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVNYXRoTGlua0Zyb21BdXRvKGZpbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW21hdGhMaW5rLCB0cnVlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt2YWx1ZSwgZmFsc2VdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaW5lID09PSAnLS0tJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGFzeW5jIGdlbmVyYXRlTWF0aExpbmtGcm9tQXV0byhmaWxlOiBUZmlsZSk6IHN0cmluZyB7XG4gICAgICAgIGxldCB0ZW1wbGF0ZXMgPSB0aGlzLnNldHRpbmdzLnRlbXBsYXRlcztcbiAgICAgICAgbGV0IG1hdGhMaW5rID0gZmlsZS5uYW1lLnJlcGxhY2UoJ1xcLm1kJywgJycpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRlbXBsYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IHJlcGxhY2VkID0gbmV3IFJlZ0V4cChmb3JtYXRSZWdleCh0ZW1wbGF0ZXNbaV0ucmVwbGFjZWQpKTtcbiAgICAgICAgICAgIGxldCByZXBsYWNlbWVudCA9IHRlbXBsYXRlc1tpXS5yZXBsYWNlbWVudDtcblxuICAgICAgICAgICAgbGV0IGZsYWdzID0gJyc7XG4gICAgICAgICAgICBpZiAodGVtcGxhdGVzW2ldLmdsb2JhbE1hdGNoKVxuICAgICAgICAgICAgICAgIGZsYWdzICs9ICdnJztcbiAgICAgICAgICAgIGlmICghdGVtcGxhdGVzW2ldLnNlbnNpdGl2ZSlcbiAgICAgICAgICAgICAgICBmbGFncyArPSAnaSc7XG5cbiAgICAgICAgICAgIGlmICh0ZW1wbGF0ZXNbaV0ud29yZClcbiAgICAgICAgICAgICAgICByZXBsYWNlZCA9IFJlZ0V4cChyZXBsYWNlZC5zb3VyY2UucmVwbGFjZSgvXi8sICdcXFxcYicpLnJlcGxhY2UoLyQvLCAnXFxcXGInKSwgZmxhZ3MpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJlcGxhY2VkID0gUmVnRXhwKHJlcGxhY2VkLnNvdXJjZSwgZmxhZ3MpO1xuXG4gICAgICAgICAgICBtYXRoTGluayA9IG1hdGhMaW5rLnJlcGxhY2UocmVwbGFjZWQsIHJlcGxhY2VtZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF0aExpbms7XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlQmFja0xpbmtzKGZpbGU6IFRGaWxlLCBtYXRoTGluazogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGxldCBiYWNrTGlua0ZpbGVQYXRocyA9IHRoaXMuZ2V0QmFja0xpbmtGaWxlUGF0aHMoZmlsZSk7XG4gICAgICAgIGlmIChiYWNrTGlua0ZpbGVQYXRocy5sZW5ndGggIT0gMCkge1xuICAgICAgICAgICAgYmFja0xpbmtGaWxlUGF0aHMuZm9yRWFjaChhc3luYyAoYmFja0xpbmtGaWxlUGF0aCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBiYWNrTGlua0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYmFja0xpbmtGaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKGJhY2tMaW5rRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBiYWNrTGlua0ZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChiYWNrTGlua0ZpbGUpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbW9kaWZpZWQgPSB0aGlzLmNvbnZlcnRUb01hdGhMaW5rcyhmaWxlLm5hbWUsIGJhY2tMaW5rRmlsZUNvbnRlbnQsIG1hdGhMaW5rKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoYmFja0xpbmtGaWxlQ29udGVudCAhPSBtb2RpZmllZClcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShiYWNrTGlua0ZpbGUsIG1vZGlmaWVkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIHJlbW92ZUJhY2tNYXRoTGlua3MoZmlsZTogVEZpbGUpOiB2b2lkIHtcbiAgICAgICAgbGV0IGJhY2tMaW5rRmlsZVBhdGhzID0gdGhpcy5nZXRCYWNrTGlua0ZpbGVQYXRocyhmaWxlKTtcbiAgICAgICAgaWYgKGJhY2tMaW5rRmlsZVBhdGhzLmxlbmd0aCAhPSAwKSB7XG4gICAgICAgICAgICBiYWNrTGlua0ZpbGVQYXRocy5mb3JFYWNoKGFzeW5jIChiYWNrTGlua0ZpbGVQYXRoKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGJhY2tMaW5rRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChiYWNrTGlua0ZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICBpZiAoYmFja0xpbmtGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGJhY2tMaW5rRmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGJhY2tMaW5rRmlsZSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YXVsdFBhdGggPSB0aGlzLmFwcC52YXVsdC5nZXRSb290KCkudmF1bHQuYWRhcHRlci5iYXNlUGF0aDtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbmZpZ0RpciA9IHRoaXMuYXBwLnZhdWx0LmNvbmZpZ0RpcjtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGlmaWVkID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGxldCBvYnNpZGlhbkNvbmZpZ0ZpbGUgPSBhd2FpdCBmcy5yZWFkRmlsZShgJHt2YXVsdFBhdGh9LyR7Y29uZmlnRGlyfS9hcHAuanNvbmAsICd1dGY4JywgKGVyciwgZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEpTT04ucGFyc2UoZGF0YSkudXNlTWFya2Rvd25MaW5rcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllZCA9IHRoaXMuY29udmVydFRvTWFya2Rvd25MaW5rcyhmaWxlLm5hbWUsIGJhY2tMaW5rRmlsZUNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkID0gdGhpcy5jb252ZXJ0VG9Eb3VibGVMaW5rcyhmaWxlLm5hbWUsIGJhY2tMaW5rRmlsZUNvbnRlbnQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmFja0xpbmtGaWxlQ29udGVudCAhPSBtb2RpZmllZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5tb2RpZnkoYmFja0xpbmtGaWxlLCBtb2RpZmllZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlT3V0TGlua3MoZmlsZTogVEZpbGUpOiB2b2lkIHtcbiAgICAgICAgbGV0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgbGV0IG1vZGlmaWVkID0gZmlsZUNvbnRlbnQ7XG5cbiAgICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgICAgbGV0IG91dExpbmtzID0gYXdhaXQgdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSkubGlua3M7XG4gICAgICAgIGlmIChvdXRMaW5rcyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG91dExpbmtzLmZvckVhY2goYXN5bmMgKG91dExpbmspID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgb3V0TGlua0ZpbGVOYW1lID0gb3V0TGluay5saW5rO1xuICAgICAgICAgICAgICAgIGlmIChvdXRMaW5rLmRpc3BsYXlUZXh0ICE9IFwiXCIpXG4gICAgICAgICAgICAgICAgICAgIG91dExpbmtGaWxlTmFtZSA9IG91dExpbmtGaWxlTmFtZS5yZXBsYWNlKC8kLywgJy5tZCcpO1xuXG4gICAgICAgICAgICAgICAgbGV0IG91dExpbmtGaWxlUGF0aCA9IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLmdldE5ld0ZpbGVQYXJlbnQob3V0TGlua0ZpbGVOYW1lKS5wYXRoICsgJy8nICsgb3V0TGlua0ZpbGVOYW1lO1xuICAgICAgICAgICAgICAgIGxldCBvdXRMaW5rRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChvdXRMaW5rRmlsZVBhdGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG91dExpbmtGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG91dExpbmtNYXRoTGluayA9IGF3YWl0IHRoaXMuZ2V0TWF0aExpbmsob3V0TGlua0ZpbGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3V0TGlua01hdGhMaW5rICE9IG51bGwgJiYgb3V0TGlua01hdGhMaW5rICE9IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGlmaWVkID0gdGhpcy5jb252ZXJ0VG9NYXRoTGlua3Mob3V0TGlua0ZpbGVOYW1lLCBtb2RpZmllZCwgb3V0TGlua01hdGhMaW5rWzBdKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICAgIGlmIChjb3VudCA9PT0gb3V0TGlua3MubGVuZ3RoICYmIGZpbGVDb250ZW50ICE9IG1vZGlmaWVkKVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbW9kaWZpZWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVBdXRvTm90ZXMoKTogdm9pZCB7XG4gICAgICAgIGxldCBhbGxOb3RlcyA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICAgICAgbGV0IGFsbEluY2x1ZGVkTm90ZXMgPSBnZXRJbmNsdWRlZE5vdGVzKGFsbE5vdGVzLCB0aGlzLnNldHRpbmdzLmV4Y2x1ZGVkRmlsZVBhdGhzKTtcbiAgICAgICAgYWxsSW5jbHVkZWROb3Rlcy5mb3JFYWNoKGFzeW5jIChub3RlKSA9PiB7XG4gICAgICAgICAgICBsZXQgbWF0aExpbmsgPSBhd2FpdCB0aGlzLmdldE1hdGhMaW5rKG5vdGUpO1xuICAgICAgICAgICAgaWYgKG1hdGhMaW5rICE9IG51bGwgJiYgbWF0aExpbmsgIT0gdW5kZWZpbmVkICYmIG1hdGhMaW5rWzFdKVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQmFja0xpbmtzKG5vdGUsIG1hdGhMaW5rWzBdKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUJhY2tNYXRoTGlua3Mobm90ZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldEJhY2tMaW5rRmlsZVBhdGhzKGZpbGU6IFRmaWxlKTogc3RyaW5nW10ge1xuICAgICAgICBsZXQgYmFja0xpbmtGaWxlUGF0aHM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUucmVzb2x2ZWRMaW5rcykuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBsZXQgbGlua3MgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLnJlc29sdmVkTGlua3Nba2V5XTtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGxpbmtzKS5mb3JFYWNoKChsaW5rKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGxpbmsgPT09IGZpbGUucGF0aClcbiAgICAgICAgICAgICAgICAgICAgYmFja0xpbmtGaWxlUGF0aHMucHVzaChrZXkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBiYWNrTGlua0ZpbGVQYXRocztcbiAgICB9XG5cbiAgICBjb252ZXJ0VG9NYXRoTGlua3MoZmlsZU5hbWU6IHN0cmluZywgZmlsZUNvbnRlbnQ6IHN0cmluZywgbWF0aExpbms6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBsZWZ0ID0gbWF0aExpbmsucmVwbGFjZSgvXi8sICdbJykucmVwbGFjZSgvJC8sICddJyk7XG4gICAgICAgIGxldCByaWdodCA9IGZpbGVOYW1lLnJlcGxhY2UoL14vLCAnKCcpLnJlcGxhY2UoLyQvLCAnKScpLnJlcGxhY2UoL1xccy9nLCAnJTIwJyk7XG4gICAgICAgIGxldCBuZXdMaW5rID0gYCR7bGVmdH0ke3JpZ2h0fWA7XG5cbiAgICAgICAgbGV0IG1peGVkTGluayA9IG5ldyBSZWdFeHAoJ1xcXFxbKCg/IVxcXFxdXFxcXCh8XFxcXF1cXFxcXSkuKSpcXFxcXScgKyBmb3JtYXRSZWdleChyaWdodCksICdnJyk7XG4gICAgICAgIGxldCBkb3VibGVMaW5rID0gbmV3IFJlZ0V4cChmb3JtYXRSZWdleChmaWxlTmFtZS5yZXBsYWNlKC9eLywgJ1xcW1xcWycpLnJlcGxhY2UoL1xcLm1kJC8sICdcXF1cXF0nKSksICdnJyk7XG5cbiAgICAgICAgcmV0dXJuIGZpbGVDb250ZW50LnJlcGxhY2UobWl4ZWRMaW5rLCBuZXdMaW5rKS5yZXBsYWNlKGRvdWJsZUxpbmssIG5ld0xpbmspO1xuICAgIH1cblxuICAgIGNvbnZlcnRUb0RvdWJsZUxpbmtzKGZpbGVOYW1lOiBzdHJpbmcsIGZpbGVDb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgZm9ybWF0dGVkTmFtZSA9IGZpbGVOYW1lLnJlcGxhY2UoL14vLCAnKCcpLnJlcGxhY2UoLyQvLCAnKScpLnJlcGxhY2UoL1xccy9nLCAnJTIwJyk7XG5cbiAgICAgICAgbGV0IG1peGVkTGluayA9IG5ldyBSZWdFeHAoJ1xcXFxbKCg/IVxcXFxdXFxcXCh8XFxcXF1cXFxcXSkuKSpcXFxcXScgKyBmb3JtYXRSZWdleChmb3JtYXR0ZWROYW1lKSwgJ2cnKTtcbiAgICAgICAgbGV0IGRvdWJsZUxpbmsgPSBmaWxlTmFtZS5yZXBsYWNlKC9eLywgJ1tbJykucmVwbGFjZSgvXFwubWQkLywgJ11dJyk7XG5cbiAgICAgICAgcmV0dXJuIGZpbGVDb250ZW50LnJlcGxhY2UobWl4ZWRMaW5rLCBkb3VibGVMaW5rKTtcbiAgICB9XG5cbiAgICBjb252ZXJ0VG9NYXJrZG93bkxpbmtzKGZpbGVOYW1lOiBzdHJpbmcsIGZpbGVDb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgZm9ybWF0dGVkTmFtZSA9IGZpbGVOYW1lLnJlcGxhY2UoL14vLCAnKCcpLnJlcGxhY2UoLyQvLCAnKScpLnJlcGxhY2UoL1xccy9nLCAnJTIwJyk7XG5cbiAgICAgICAgbGV0IG1peGVkTGluayA9IG5ldyBSZWdFeHAoJ1xcXFxbKCg/IVxcXFxdXFxcXCh8XFxcXF1cXFxcXSkuKSpcXFxcXScgKyBmb3JtYXRSZWdleChmb3JtYXR0ZWROYW1lKSwgJ2cnKTtcbiAgICAgICAgbGV0IG1hcmtkb3duTGluayA9IGZpbGVOYW1lLnJlcGxhY2UoL14vLCAnWycpLnJlcGxhY2UoL1xcLm1kJC8sIGBdJHtmb3JtYXR0ZWROYW1lfWApO1xuXG4gICAgICAgIHJldHVybiBmaWxlQ29udGVudC5yZXBsYWNlKG1peGVkTGluaywgbWFya2Rvd25MaW5rKTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgU2V0dGluZywgUGx1Z2luU2V0dGluZ1RhYiwgTW9kYWwsIFRleHRDb21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBOb3RpY2UsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIE1hdGhMaW5rc1NldHRpbmdzIHtcbiAgICB0ZW1wbGF0ZXM6IHN0cmluZ1tdO1xuICAgIGV4Y2x1ZGVkRmlsZVBhdGhzOiBzdHJpbmdbXTtcbiAgICBhdXRvVXBkYXRlOiBib29sZWFuO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTWF0aExpbmtzU2V0dGluZ3MgPSB7XG4gICAgdGVtcGxhdGVzOiBbXSxcbiAgICBleGNsdWRlZEZpbGVQYXRoczogW10sXG4gICAgYXV0b1VwZGF0ZTogdHJ1ZVxufVxuXG5leHBvcnQgY2xhc3MgTWF0aExpbmtzU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogTWF0aExpbmtzO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTWF0aExpbmtzKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgYXN5bmMgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ01hdGhMaW5rcyBTZXR0aW5ncyd9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdVcGRhdGUgd2hlbiBtb2RpZmllZCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnQXV0b21hdGljYWxseSB1cGRhdGUgbGlua3MgaW4gdGhlIGN1cnJlbnQgZmlsZSB3aGVuIG1vZGlmaWVkLicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHt0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b1VwZGF0ZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKGN1cnJlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b1VwZGF0ZSA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnQWRkIGEgbmV3IHRlbXBsYXRlJylcbiAgICAgICAgICAgIC5zZXREZXNjKFxuICAgICAgICAgICAgICAgIGNyZWF0ZUZyYWdtZW50KChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGUuY3JlYXRlU3Bhbih7dGV4dDogJ0dlbmVyYXRlIG1hdGhMaW5rcyB3aXRoIGEgbmV3IHRlbXBsYXRlLiBVc2UgJ30pO1xuICAgICAgICAgICAgICAgICAgICBlLmNyZWF0ZUVsKCdjb2RlJywge3RleHQ6ICdtYXRoTGluazogYXV0byd9KTtcbiAgICAgICAgICAgICAgICAgICAgZS5jcmVhdGVTcGFuKHt0ZXh0OiAnIHRvIHVzZSB0ZW1wbGF0ZXMgaW4gYSBmaWxlLid9KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnV0dG9uOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBiID0gYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQWRkXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwicGx1c1wiKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbW9kYWwgPSBuZXcgQWRkVGVtcGxhdGVzTW9kYWwodGhpcy5hcHApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vbkNsb3NlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RhbC5zYXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBtb2RhbC50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VkOiBtb2RhbC5yZXBsYWNlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50OiBtb2RhbC5yZXBsYWNlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbE1hdGNoOiBtb2RhbC5nbG9iYWxNYXRjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnNpdGl2ZTogbW9kYWwuc2Vuc2l0aXZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29yZDogbW9kYWwud29yZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlcy5wdXNoKHRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUF1dG9Ob3RlcygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ01hdGhMaW5rczogVGVtcGxhdGUgYWRkZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBsZXQgdGVtcGxhdGVUaXRsZTogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRWRpdC9kZWxldGUgdGVtcGxhdGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1NlbGVjdCBhIHRlbXBsYXRlIHRvIGVkaXQvZGVsZXRlIGl0LicpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duOiBEcm9wZG93bkNvbXBvbmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihcIl9fc2VsZWN0XCIsIFwiU2VsZWN0XCIpO1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlcy5mb3JFYWNoKCh0ZW1wbGF0ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24odGVtcGxhdGUudGl0bGUsIHRlbXBsYXRlLnRpdGxlKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jIChjdXJyZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50ICE9ICdfX3NlbGVjdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVRpdGxlID0gY3VycmVudDtcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVUaXRsZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmFkZEV4dHJhQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGIgPSBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJFZGl0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwiZWRpdFwiKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGVtcGxhdGVUaXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvcmlnaW5hbFRlbXBsYXRlcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IEVkaXRUZW1wbGF0ZXNNb2RhbCh0aGlzLmFwcCwgdGVtcGxhdGVUaXRsZSwgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLm9uQ2xvc2UgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RhbC5zYXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVBdXRvTm90ZXMoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnTWF0aExpbmtzOiBUZW1wbGF0ZSBzYXZlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVzID0gb3JpZ2luYWxUZW1wbGF0ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdNYXRoTGlua3M6IFBsZWFzZSBzZWxlY3QgYSB0ZW1wbGF0ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYjtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYWRkRXh0cmFCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgYiA9IGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkRlbGV0ZVwiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZVRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IERlbGV0ZU1vZGFsKHRoaXMuYXBwLCBgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSAnJHt0ZW1wbGF0ZVRpdGxlfSc/YCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vbkNsb3NlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kYWwuc2F2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlc1tpXS50aXRsZSA9PT0gdGVtcGxhdGVUaXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTWF0aExpbmtzOiBUZW1wbGF0ZSAnJHt0ZW1wbGF0ZVRpdGxlfScgZGVsZXRlZGApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdNYXRoTGlua3M6IFBsZWFzZSBzZWxlY3QgYSB0ZW1wbGF0ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYjtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0FkZCBhbiBleGNsdWRlZCBmaWxlJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdNYXRoTGlua3Mgd2lsbCBpZ25vcmUgdGhvc2UgZmlsZXMuJylcbiAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgYiA9IGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkFkZFwiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcInBsdXNcIilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IEFkZEV4Y2x1ZGVkTW9kYWwodGhpcy5hcHApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vbkNsb3NlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RhbC5zYXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGNsdWRlZEZpbGVQYXRoID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogbW9kYWwuZXhjbHVkZWRGaWxlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRmlsZTogbW9kYWwuaXNGaWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlZEZpbGVQYXRocy5wdXNoKGV4Y2x1ZGVkRmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kYWwuaXNGaWxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnTWF0aExpbmtzOiBGaWxlIGV4Y2x1ZGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ01hdGhMaW5rczogUGF0aCBleGNsY3VkZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBsZXQgZXhjbHVkZWRGaWxlUGF0aDogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVtb3ZlIGZyb20gZXhjbHVkZWQgZmlsZXMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1JlbW92ZSBhIGZpbGUgZnJvbSB0aGUgbGlzdCBvZiBleGNsdWRlZCBmaWxlcy4nKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGFzeW5jIChkcm9wZG93bjogRHJvcGRvd25Db21wb25lbnQpID0+IHtcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oXCJfX3NlbGVjdFwiLCBcIlNlbGVjdFwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlZEZpbGVQYXRocy5mb3JFYWNoKChleGNsdWRlZEZpbGVQYXRoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihleGNsdWRlZEZpbGVQYXRoLnBhdGgsIGV4Y2x1ZGVkRmlsZVBhdGgucGF0aCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAoY3VycmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudCAhPSAnX19zZWxlY3QnKVxuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZWRGaWxlUGF0aCA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkRmlsZVBhdGggPSBudWxsO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBiID0gYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiUmVtb3ZlXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4Y2x1ZGVkRmlsZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbW9kYWwgPSBuZXcgRGVsZXRlTW9kYWwodGhpcy5hcHAsIGBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gcmVtb3ZlICcke2V4Y2x1ZGVkRmlsZVBhdGh9JyBmcm9tIHRoZSBsaXN0IG9mIGV4Y2x1ZGVkIGZpbGVzL3BhdGhzP2ApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub25DbG9zZSA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGFsLnNhdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGVkRmlsZVBhdGhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGVkRmlsZVBhdGhzW2ldLnBhdGggPT09IGV4Y2x1ZGVkRmlsZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZWRGaWxlUGF0aHMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTWF0aExpbmtzOiAnJHtleGNsdWRlZEZpbGVQYXRofScgcmVtb3ZlZCBmcm9tIGV4Y2x1ZGVkIGZpbGVzYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ01hdGhMaW5rczogUGxlYXNlIHNlbGVjdCBhIGZpbGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XG5cbmNsYXNzIEFkZFRlbXBsYXRlc01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHNhdmVkOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJvY2VlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgdGl0bGU6IHN0cmluZyA9ICcnO1xuICAgIHJlcGxhY2VkOiBzdHJpbmcgPSAnJztcbiAgICByZXBsYWNlbWVudDogc3RyaW5nID0gJyc7XG4gICAgZ2xvYmFsTWF0Y2g6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHNlbnNpdGl2ZTogYm9vbGVhbiA9IHRydWU7XG4gICAgd29yZDogYm9vbGVhbiA9IHRydWVcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG5cbiAgICAgICAgbG9hZFRlbXBsYXRlU2V0dGluZ3MoY29udGVudEVsLCB0aGlzKTtcbiAgICAgICAgbG9hZEJ1dHRvbnNUb0Nsb3NlKHRoaXMsIHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpLCB0cnVlLCAnQWRkJywgJ2NoZWNrbWFyaycsICdDYW5jZWwnLCAnY3Jvc3MnKTtcbiAgICB9XG59XG5cbmNsYXNzIEVkaXRUZW1wbGF0ZXNNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByb2NlZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIHRlbXBsYXRlVGl0bGU6IHN0cmluZztcbiAgICB0ZW1wbGF0ZXM6IHN0cmluZ1tdO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRlbXBsYXRlVGl0bGU6IHN0cmluZywgdGVtcGxhdGVzOiBzdHJpbmdbXSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnRlbXBsYXRlVGl0bGUgPSB0ZW1wbGF0ZVRpdGxlO1xuICAgICAgICB0aGlzLnRlbXBsYXRlcyA9IHRlbXBsYXRlcztcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgICAgICB0aGlzLnRlbXBsYXRlcy5ldmVyeSgodGVtcGxhdGUpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRlbXBsYXRlVGl0bGUgIT0gdW5kZWZpbmVkICYmIHRlbXBsYXRlLnRpdGxlID09IHRoaXMudGVtcGxhdGVUaXRsZSkge1xuICAgICAgICAgICAgICAgIGxvYWRUZW1wbGF0ZVNldHRpbmdzKGNvbnRlbnRFbCwgdGVtcGxhdGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KVxuXG4gICAgICAgIGxvYWRCdXR0b25zVG9DbG9zZSh0aGlzLCB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKSwgdHJ1ZSwgJ1NhdmUnLCAnY2hlY2ttYXJrJywgJ0NhbmNlbCcsICdjcm9zcycpO1xuICAgIH1cbn1cblxuY2xhc3MgQWRkRXhjbHVkZWRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByb2NlZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGV4Y2x1ZGVkRmlsZVBhdGg6IHN0cmluZztcbiAgICBpc0ZpbGU6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgICAgIGxldCBleGNsdWRlZEZpbGVQYXRoVGV4dDogVGV4dENvbXBvbmVudDtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0ZpbGUgbmFtZS9wYXRoIG9mIGZvbGRlcicpXG4gICAgICAgICAgICAuc2V0RGVzYyhcbiAgICAgICAgICAgICAgICBjcmVhdGVGcmFnbWVudCgoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBlLmNyZWF0ZVNwYW4oe3RleHQ6ICdFbnRlciBhIGZpbGUgYXMnfSk7XG4gICAgICAgICAgICAgICAgICAgIGUuY3JlYXRlRWwoJ2NvZGUnLCB7dGV4dDogJ3BhdGgvbmFtZS5tZCd9KTtcbiAgICAgICAgICAgICAgICAgICAgZS5jcmVhdGVTcGFuKHt0ZXh0OiAnIGFuZCBhIGZvbGRlciBhcyAnfSk7XG4gICAgICAgICAgICAgICAgICAgIGUuY3JlYXRlRWwoJ2NvZGUnLCB7dGV4dDogJ3BhdGgnfSk7XG4gICAgICAgICAgICAgICAgICAgIGUuY3JlYXRlU3Bhbih7dGV4dDogJy4nfSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgZXhjbHVkZWRGaWxlUGF0aFRleHQgPSB0ZXh0O1xuICAgICAgICAgICAgICAgIGxldCBmb290ZXJFbCA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICAgICAgICAgIGxvYWRCdXR0b25zVG9DbG9zZSh0aGlzLCBmb290ZXJFbCwgdGhpcy5wcm9jZWVkLCAnQWRkJywgJ2NoZWNrbWFyaycsICdDYW5jZWwnLCAnY3Jvc3MnKTtcbiAgICAgICAgICAgICAgICBleGNsdWRlZEZpbGVQYXRoVGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoZXhjbHVkZWRGaWxlUGF0aFRleHQpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgoY3VycmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbGUgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGN1cnJlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhjbHVkZWRGaWxlUGF0aCA9IGZpbGUucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRmlsZSA9IGZpbGUgaW5zdGFuY2VvZiBURmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2NlZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2NlZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlckVsLmVtcHR5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkQnV0dG9uc1RvQ2xvc2UodGhpcywgZm9vdGVyRWwsIHRoaXMucHJvY2VlZCwgJ0FkZCcsICdjaGVja21hcmsnLCAnQ2FuY2VsJywgJ2Nyb3NzJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxufVxuXG5jbGFzcyBEZWxldGVNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByb2NlZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGFyZVlvdVN1cmU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBhcmVZb3VTdXJlOiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hcmVZb3VTdXJlID0gYXJlWW91U3VyZTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gzJywge3RleHQ6IHRoaXMuYXJlWW91U3VyZX0pO1xuICAgICAgICBsb2FkQnV0dG9uc1RvQ2xvc2UodGhpcywgdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCksIHRydWUsICdZZXMnLCAnY2hlY2ttYXJrJywgJ05vJywgJ2Nyb3NzJyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBsb2FkVGVtcGxhdGVTZXR0aW5ncyhjb250ZW50RWw6IEhUTUxFbGVtZW50LCB0ZW1wbGF0ZTogb2JqZWN0KSB7XG4gICAgbGV0IHRpdGxlVGV4dDogVGV4dENvbXBvbmVudDtcbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgIC5zZXROYW1lKCdUaXRsZScpXG4gICAgICAgIC5zZXREZXNjKCdOYW1lIG9mIHRoZSB0ZW1wbGF0ZS4nKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4ge1xuICAgICAgICAgICAgdGl0bGVUZXh0ID0gdGV4dDtcbiAgICAgICAgICAgIHRpdGxlVGV4dC5zZXRWYWx1ZSh0ZW1wbGF0ZS50aXRsZSkub25DaGFuZ2UoKGN1cnJlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZS50aXRsZSA9IGN1cnJlbnQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICBsZXQgcmVwbGFjZWRUZXh0OiBUZXh0Q29tcG9uZW50O1xuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgLnNldE5hbWUoJ01hdGNoIGZvci4uLicpXG4gICAgICAgIC5zZXREZXNjKCdTdHJpbmcgdG8gYmUgbWF0Y2hlZCBhbmQgcmVwbGFjZWQuIERvIG5vdCBpbmNsdWRlIHJlZ2V4LicpXG4gICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICByZXBsYWNlZFRleHQgPSB0ZXh0O1xuICAgICAgICAgICAgcmVwbGFjZWRUZXh0LnNldFZhbHVlKHRlbXBsYXRlLnJlcGxhY2VkKS5vbkNoYW5nZSgoY3VycmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlLnJlcGxhY2VkID0gY3VycmVudDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgIGxldCByZXBsYWNlbWVudFRleHQ6IFRleHRDb21wb25lbnQ7XG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAuc2V0TmFtZSgnUmVwbGFjZSB3aXRoLi4uJylcbiAgICAgICAgLnNldERlc2MoJ1N0cmluZyB0byByZXBsYWNlIG1hdGNoZXMuIERvIG5vdCBlc2NhcGUgYmFja3NsYXNoZXMuJylcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHtcbiAgICAgICAgICAgIHJlcGxhY2VtZW50VGV4dCA9IHRleHQ7XG4gICAgICAgICAgICByZXBsYWNlbWVudFRleHQuc2V0VmFsdWUodGVtcGxhdGUucmVwbGFjZW1lbnQpLm9uQ2hhbmdlKChjdXJyZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGUucmVwbGFjZW1lbnQgPSBjdXJyZW50O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAuc2V0TmFtZSgnR2xvYmFsIG1hdGNoJylcbiAgICAgICAgLnNldERlc2MoJ01hdGNoIGFsbCBpbnN0YW5jZXMgKGluc3RlYWQgb2YganVzdCB0aGUgZmlyc3QpLicpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xuICAgICAgICAgICAgdG9nZ2xlLnNldFZhbHVlKHRlbXBsYXRlLmdsb2JhbE1hdGNoKS5vbkNoYW5nZSgoY3VycmVudCkgPT4gKHRlbXBsYXRlLmdsb2JhbE1hdGNoID0gY3VycmVudCkpO1xuICAgICAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgLnNldE5hbWUoJ0Nhc2Ugc2Vuc2l0aXZlJylcbiAgICAgICAgLnNldERlc2MoJ01hdGNoZXMgd2lsbCBiZSBjYXNlIHNlbnNpdGl2ZS4nKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcbiAgICAgICAgICAgIHRvZ2dsZS5zZXRWYWx1ZSh0ZW1wbGF0ZS5zZW5zaXRpdmUpLm9uQ2hhbmdlKChjdXJyZW50KSA9PiAodGVtcGxhdGUuc2Vuc2l0aXZlID0gY3VycmVudCkpO1xuICAgICAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgLnNldE5hbWUoJ01hdGNoIHdob2xlIHdvcmRzJylcbiAgICAgICAgLnNldERlc2MoJ09ubHkgbWF0Y2ggd2hvbGUgd29yZHMuJylcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XG4gICAgICAgICAgICB0b2dnbGUuc2V0VmFsdWUodGVtcGxhdGUud29yZCkub25DaGFuZ2UoKGN1cnJlbnQpID0+ICh0ZW1wbGF0ZS53b3JkID0gY3VycmVudCkpO1xuICAgICAgICB9KTtcbn1cblxuZnVuY3Rpb24gbG9hZEJ1dHRvbnNUb0Nsb3NlKG1vZGFsOiBNb2RhbCwgZWxlbWVudDogSFRNTEVsZW1lbnQsIHByb2NlZWQ6IGJvb2xlYW4sIHRydWVUb29sVGlwOiBzdHJpbmcsIHRydWVJY29uOiBzdHJpbmcsIGZhbHNlVG9vbFRpcDogc3RyaW5nLCBmYWxzZUljb246IHN0cmluZykge1xuICAgIGxldCBmb290ZXJCdXR0b25zID0gbmV3IFNldHRpbmcoZWxlbWVudCk7XG4gICAgZm9vdGVyQnV0dG9ucy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgYi5zZXRUb29sdGlwKHRydWVUb29sVGlwKVxuICAgICAgICAgICAgLnNldEljb24odHJ1ZUljb24pXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFwcm9jZWVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ01hdGhMaW5rczogUGxlYXNlIGVudGVyIGEgdmFsaWQgcGF0aC9maWxlJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwuc2F2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH0pO1xuICAgIGZvb3RlckJ1dHRvbnMuYWRkRXh0cmFCdXR0b24oKGIpID0+IHtcbiAgICAgICAgYi5zZXRUb29sdGlwKGZhbHNlVG9vbFRpcClcbiAgICAgICAgICAgIC5zZXRJY29uKGZhbHNlSWNvbilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBtb2RhbC5zYXZlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFJlZ2V4KHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gc3RyXG4gICAgICAgIC5yZXBsYWNlKC9cXHMvZywgJ1xcXFxzJylcbiAgICAgICAgLnJlcGxhY2UoL1xcLi9nLCAnXFxcXC4nKVxuICAgICAgICAucmVwbGFjZSgvXFwoL2csICdcXFxcKCcpXG4gICAgICAgIC5yZXBsYWNlKC9cXCkvZywgJ1xcXFwpJylcbiAgICAgICAgLnJlcGxhY2UoL1xcey9nLCAnXFxcXHsnKVxuICAgICAgICAucmVwbGFjZSgvXFx9L2csICdcXFxcfScpXG4gICAgICAgIC5yZXBsYWNlKC9cXFsvZywgJ1xcXFxbJylcbiAgICAgICAgLnJlcGxhY2UoL1xcXS9nLCAnXFxcXF0nKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRXhjbHVkZWQoZmlsZTogVEZpbGUsIGV4Y2x1ZGVkRmlsZVBhdGhzOiBzdHJpbmdbXSk6IGJvb2xlYW4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXhjbHVkZWRGaWxlUGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IHBhdGggPSBleGNsdWRlZEZpbGVQYXRoc1tpXTtcbiAgICAgICAgaWYgKHBhdGguaXNGaWxlICYmIGZpbGUucGF0aCA9PT0gcGF0aC5wYXRoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmICghcGF0aC5pc0ZpbGUpIHtcbiAgICAgICAgICAgIGxldCBwYXRoUmVnZXggPSBuZXcgUmVnRXhwKGBcXFxcYiR7cGF0aC5wYXRofS9gKTtcbiAgICAgICAgICAgIGlmIChwYXRoUmVnZXgudGVzdChmaWxlLnBhdGgpKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEluY2x1ZGVkTm90ZXMoYWxsTm90ZXM6IFRGaWxlW10sIGV4Y2x1ZGVkRmlsZVBhdGhzOiBzdHJpbmdbXSk6IFRGaWxlW10ge1xuICAgIGxldCBhbGxJbmNsdWRlZE5vdGVzOiBURmlsZVtdID0gW107XG4gICAgYWxsTm90ZXMuZm9yRWFjaCgobm90ZSkgPT4ge1xuICAgICAgICBpZiAoIWlzRXhjbHVkZWQobm90ZSwgZXhjbHVkZWRGaWxlUGF0aHMpKVxuICAgICAgICAgICAgYWxsSW5jbHVkZWROb3Rlcy5wdXNoKG5vdGUpO1xuICAgIH0pO1xuICAgIHJldHVybiBhbGxJbmNsdWRlZE5vdGVzO1xufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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
