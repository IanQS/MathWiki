/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin:
https://github.com/zhaoshenzhai/obsidian-mathlinks
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target, mod));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MathLinks
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  templates: [],
  excludedFilePaths: [],
  autoUpdate: true
};
var MathLinksSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    return __async(this, null, function* () {
      const { containerEl } = this;
      containerEl.empty();
      containerEl.createEl("h2", { text: "MathLinks Settings" });
      new import_obsidian.Setting(containerEl).setName("Update when modified").setDesc("Automatically update links in the current file when modified.").addToggle((toggle) => {
        toggle.setValue(this.plugin.settings.autoUpdate).onChange((current) => __async(this, null, function* () {
          this.plugin.settings.autoUpdate = current;
          yield this.plugin.saveSettings();
        }));
      });
      new import_obsidian.Setting(containerEl).setName("Add a new template").setDesc(createFragment((e) => {
        e.createSpan({ text: "Generate mathLinks with a new template. Use " });
        e.createEl("code", { text: "mathLink: auto" });
        e.createSpan({ text: " to use templates in a file." });
      })).addButton((button) => {
        let b = button.setTooltip("Add").setIcon("plus").onClick(() => __async(this, null, function* () {
          let modal = new AddTemplatesModal(this.app, this.plugin.settings.templates);
          modal.onClose = () => __async(this, null, function* () {
            if (modal.saved) {
              const template = {
                title: modal.title,
                replaced: modal.replaced,
                replacement: modal.replacement,
                globalMatch: modal.globalMatch,
                sensitive: modal.sensitive,
                word: modal.word
              };
              this.plugin.settings.templates.push(template);
              yield this.plugin.saveSettings();
              this.plugin.updateAutoNotes();
              new import_obsidian.Notice("MathLinks: Template added");
            }
          });
          modal.open();
          this.display();
        }));
        return b;
      });
      let templateTitle;
      new import_obsidian.Setting(containerEl).setName("Edit/delete template").setDesc("Select a template to edit/delete it.").addDropdown((dropdown) => {
        dropdown.addOption("__select", "Select");
        this.plugin.settings.templates.forEach((template) => {
          dropdown.addOption(template.title, template.title);
        });
        dropdown.onChange((current) => __async(this, null, function* () {
          if (current != "__select")
            templateTitle = current;
          else
            templateTitle = null;
        }));
      }).addExtraButton((button) => {
        let b = button.setTooltip("Edit").setIcon("edit").onClick(() => __async(this, null, function* () {
          if (templateTitle) {
            let originalTemplates = JSON.parse(JSON.stringify(this.plugin.settings.templates));
            let modal = new EditTemplatesModal(this.app, templateTitle, this.plugin.settings.templates);
            modal.onClose = () => __async(this, null, function* () {
              if (modal.saved) {
                yield this.plugin.saveSettings();
                this.plugin.updateAutoNotes();
                new import_obsidian.Notice("MathLinks: Template saved");
              } else {
                this.plugin.settings.templates = originalTemplates;
              }
            });
            modal.open();
            this.display();
          } else {
            new import_obsidian.Notice("MathLinks: Please select a template");
          }
        }));
        return b;
      }).addExtraButton((button) => {
        let b = button.setTooltip("Delete").setIcon("trash").onClick(() => __async(this, null, function* () {
          if (templateTitle) {
            let modal = new DeleteModal(this.app, `Are you sure you want to delete '${templateTitle}'?`);
            modal.onClose = () => __async(this, null, function* () {
              if (modal.saved) {
                for (let i = 0; i < this.plugin.settings.templates.length; i++) {
                  if (this.plugin.settings.templates[i].title === templateTitle) {
                    this.plugin.settings.templates.splice(i, 1);
                    yield this.plugin.saveSettings();
                    new import_obsidian.Notice(`MathLinks: Template '${templateTitle}' deleted`);
                    break;
                  }
                }
              }
            });
            modal.open();
            this.display();
          } else {
            new import_obsidian.Notice("MathLinks: Please select a template");
          }
        }));
        return b;
      });
      new import_obsidian.Setting(containerEl).setName("Add an excluded file").setDesc("MathLinks will ignore those files.").addButton((button) => {
        let b = button.setTooltip("Add").setIcon("plus").onClick(() => __async(this, null, function* () {
          let modal = new AddExcludedModal(this.app, this.plugin.settings.excludedFilePaths);
          modal.onClose = () => __async(this, null, function* () {
            if (modal.saved) {
              const excludedFilePath2 = {
                path: modal.excludedFilePath,
                isFile: modal.isFile
              };
              this.plugin.settings.excludedFilePaths.push(excludedFilePath2);
              yield this.plugin.saveSettings();
              if (modal.isFile)
                new import_obsidian.Notice("MathLinks: File excluded");
              else
                new import_obsidian.Notice("MathLinks: Path exclcuded");
            }
          });
          modal.open();
          this.display();
        }));
        return b;
      });
      let excludedFilePath;
      new import_obsidian.Setting(containerEl).setName("Remove from excluded files").setDesc("Remove a file from the list of excluded files.").addDropdown((dropdown) => __async(this, null, function* () {
        dropdown.addOption("__select", "Select");
        this.plugin.settings.excludedFilePaths.forEach((excludedFilePath2) => {
          dropdown.addOption(excludedFilePath2.path, excludedFilePath2.path);
        });
        dropdown.onChange((current) => __async(this, null, function* () {
          if (current != "__select")
            excludedFilePath = current;
          else
            excludedFilePath = null;
        }));
      })).addExtraButton((button) => {
        let b = button.setTooltip("Remove").setIcon("trash").onClick(() => __async(this, null, function* () {
          if (excludedFilePath) {
            let modal = new DeleteModal(this.app, `Are you sure you want to remove '${excludedFilePath}' from the list of excluded files/paths?`);
            modal.onClose = () => __async(this, null, function* () {
              if (modal.saved) {
                for (let i = 0; i < this.plugin.settings.excludedFilePaths.length; i++) {
                  if (this.plugin.settings.excludedFilePaths[i].path === excludedFilePath) {
                    this.plugin.settings.excludedFilePaths.splice(i, 1);
                    yield this.plugin.saveSettings();
                    new import_obsidian.Notice(`MathLinks: '${excludedFilePath}' removed from excluded files`);
                    break;
                  }
                }
              }
            });
            modal.open();
            this.display();
          } else {
            new import_obsidian.Notice("MathLinks: Please select a file");
          }
        }));
        return b;
      });
    });
  }
};
var AddTemplatesModal = class extends import_obsidian.Modal {
  constructor(app2, templates) {
    super(app2);
    this.saved = false;
    this.error = ["MathLinks: Please enter a title", "MathLinks: Please enter a non-empty string to be replaced"];
    this.title = "";
    this.replaced = "";
    this.replacement = "";
    this.globalMatch = true;
    this.sensitive = true;
    this.word = true;
    this.templates = [];
    this.templates = templates;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    loadTemplateSettings(contentEl, this, this, "add");
    loadButtonsToClose(this, this.contentEl.createDiv(), "Add", "Cancel");
  }
};
var EditTemplatesModal = class extends import_obsidian.Modal {
  constructor(app2, templateTitle, templates) {
    super(app2);
    this.saved = false;
    this.error = ["", ""];
    this.templateTitle = templateTitle;
    this.templates = templates;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    this.templates.every((template) => {
      if (this.templateTitle != void 0 && template.title == this.templateTitle) {
        loadTemplateSettings(contentEl, template, this, "edit");
        return false;
      }
      return true;
    });
    loadButtonsToClose(this, this.contentEl.createDiv(), "Save", "Cancel");
  }
};
var AddExcludedModal = class extends import_obsidian.Modal {
  constructor(app2, excludedFilePaths) {
    super(app2);
    this.saved = false;
    this.error = ["MathLinks: Please enter a valid file/path", ""];
    this.excludedFilePaths = excludedFilePaths;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    let excludedFilePathText;
    new import_obsidian.Setting(contentEl).setName("File name/path of folder").setDesc(createFragment((e) => {
      e.createSpan({ text: "Enter a file as" });
      e.createEl("code", { text: "path/name.md" });
      e.createSpan({ text: " and a folder as " });
      e.createEl("code", { text: "path" });
      e.createSpan({ text: "." });
    })).addText((text) => {
      excludedFilePathText = text;
      let footerEl = this.contentEl.createDiv();
      loadButtonsToClose(this, footerEl, "Add", "Cancel");
      excludedFilePathText.onChange((current) => {
        let file = app.vault.getAbstractFileByPath(current);
        if (file != null) {
          this.excludedFilePath = file.path;
          this.isFile = file instanceof import_obsidian.TFile;
          this.error[0] = "";
        } else {
          this.error[0] = "MathLinks: Please enter a valid file/path";
        }
        this.error[1] = "";
        this.excludedFilePaths.every((path) => {
          if (path.path == current) {
            this.error[1] = "MathLinks: Duplicate file/path";
            return false;
          }
          return true;
        });
        footerEl.empty();
        loadButtonsToClose(this, footerEl, "Add", "Cancel");
      });
    });
  }
};
var DeleteModal = class extends import_obsidian.Modal {
  constructor(app2, areYouSure) {
    super(app2);
    this.saved = false;
    this.areYouSure = areYouSure;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: this.areYouSure });
    loadButtonsToClose(this, this.contentEl.createDiv(), "Yes", "No");
  }
};
function loadTemplateSettings(contentEl, template, modal, modalType) {
  let titleText;
  new import_obsidian.Setting(contentEl).setName("Title").setDesc("Name of the template.").addText((text) => {
    titleText = text;
    titleText.setValue(template.title).onChange((current) => {
      template.title = current;
      modal.error[0] = "";
      if (modalType === "add") {
        template.templates.every((template2) => {
          if (template2.title != "" && template2.title == template2.title) {
            modal.error[0] = "MathLinks: Duplicate title";
            return false;
          }
          return true;
        });
      }
      if (template.title === "") {
        modal.error[0] = "MathLinks: Please enter a title";
      }
    });
  });
  let replacedText;
  new import_obsidian.Setting(contentEl).setName("Match for...").setDesc("String to be matched and replaced. Do not include regex.").addText((text) => {
    replacedText = text;
    replacedText.setValue(template.replaced).onChange((current) => {
      template.replaced = current;
      modal.error[1] = "";
      if (template.replaced == "") {
        modal.error[1] = "MathLinks: Please enter a non-empty string to be replaced";
      }
    });
  });
  let replacementText;
  new import_obsidian.Setting(contentEl).setName("Replace with...").setDesc("String to replace matches. Do not escape backslashes.").addText((text) => {
    replacementText = text;
    replacementText.setValue(template.replacement).onChange((current) => {
      template.replacement = current;
    });
  });
  new import_obsidian.Setting(contentEl).setName("Global match").setDesc("Match all instances (instead of just the first).").addToggle((toggle) => {
    toggle.setValue(template.globalMatch).onChange((current) => template.globalMatch = current);
  });
  new import_obsidian.Setting(contentEl).setName("Case sensitive").setDesc("Matches will be case sensitive.").addToggle((toggle) => {
    toggle.setValue(template.sensitive).onChange((current) => template.sensitive = current);
  });
  new import_obsidian.Setting(contentEl).setName("Match whole words").setDesc("Only match whole words.").addToggle((toggle) => {
    toggle.setValue(template.word).onChange((current) => template.word = current);
  });
}
function loadButtonsToClose(modal, element, trueToolTip, falseToolTip) {
  let footerButtons = new import_obsidian.Setting(element);
  footerButtons.addButton((b) => {
    b.setTooltip(trueToolTip).setIcon("checkmark").onClick(() => __async(this, null, function* () {
      let proceed = modal.error.every((error) => {
        if (error != "") {
          return false;
        }
        return true;
      });
      if (!proceed) {
        modal.error.forEach((error) => {
          if (error != "") {
            new import_obsidian.Notice(error);
          }
        });
      } else {
        modal.saved = true;
        modal.close();
      }
    }));
  });
  footerButtons.addExtraButton((b) => {
    b.setTooltip(falseToolTip).setIcon("cross").onClick(() => __async(this, null, function* () {
      modal.saved = false;
      modal.close();
    }));
  });
}

// src/utils.ts
function formatRegex(str) {
  return str.replace(/\s/g, "\\s").replace(/\./g, "\\.").replace(/\(/g, "\\(").replace(/\)/g, "\\)").replace(/\{/g, "\\{").replace(/\}/g, "\\}").replace(/\[/g, "\\[").replace(/\]/g, "\\]");
}
function isExcluded(file, excludedFilePaths) {
  for (let i = 0; i < excludedFilePaths.length; i++) {
    let path = excludedFilePaths[i];
    if (path.isFile && file.path === path.path) {
      return true;
    } else if (!path.isFile) {
      let pathRegex = new RegExp(`\\b${path.path}/`);
      if (pathRegex.test(file.path))
        return true;
    }
  }
  return false;
}
function getIncludedNotes(allNotes, excludedFilePaths) {
  let allIncludedNotes = [];
  allNotes.forEach((note) => {
    if (!isExcluded(note, excludedFilePaths))
      allIncludedNotes.push(note);
  });
  return allIncludedNotes;
}

// src/main.ts
var fs = __toESM(require("fs"));
var MathLinks = class extends import_obsidian2.Plugin {
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      this.addSettingTab(new MathLinksSettingTab(this.app, this));
      const settings = this.settings;
      this.app.metadataCache.on("changed", (file, data, cache) => __async(this, null, function* () {
        if (!settings.autoUpdate || isExcluded(file, settings.excludedFilePaths))
          return null;
        let mathLink = yield this.getMathLink(file);
        if (mathLink != null)
          this.updateBackLinks(file, mathLink[0]);
        else
          this.removeBackMathLinks(file);
        this.updateOutLinks(file);
      }));
      this.addCommand({
        id: "update_all_mathlinks",
        name: "Update all links",
        callback: () => __async(this, null, function* () {
          let allNotes = yield this.app.vault.getMarkdownFiles();
          let allIncludedNotes = getIncludedNotes(allNotes, settings.excludedFilePaths);
          let updateNotice = new Notice("MathLinks: Updating...");
          let count = 0;
          allIncludedNotes.forEach((note) => __async(this, null, function* () {
            let mathLink = yield this.getMathLink(note);
            if (mathLink != null)
              this.updateBackLinks(note, mathLink[0]);
            else
              this.removeBackMathLinks(note);
            count++;
            updateNotice.setMessage(`MathLinks: Updating... ${count}/${allIncludedNotes.length}`);
            if (count === allIncludedNotes.length) {
              updateNotice.hide();
              new Notice("MathLinks: Updated all links");
            }
          }));
        })
      });
    });
  }
  getMathLink(file) {
    return __async(this, null, function* () {
      let contents = yield this.app.vault.read(file);
      contents = contents.split(/\r?\n/);
      if (contents[0] === "---") {
        for (let lineNumber = 1; lineNumber < contents.length; lineNumber++) {
          let line = contents[lineNumber];
          if (line.length < 10) {
            lineNumber++;
          } else {
            let key = line.substring(0, 10);
            if (key === "mathLink: ") {
              let value = line.replace(key, "");
              if (value != "") {
                if (value === "auto") {
                  let mathLink = yield this.generateMathLinkFromAuto(file);
                  return [mathLink, true];
                }
                return [value, false];
              } else {
                return null;
              }
            } else if (line === "---") {
              return null;
            } else {
              lineNumber++;
            }
          }
        }
      }
      return null;
    });
  }
  generateMathLinkFromAuto(file) {
    return __async(this, null, function* () {
      let templates = this.settings.templates;
      let mathLink = file.name.replace(".md", "");
      for (let i = 0; i < templates.length; i++) {
        let replaced = new RegExp(formatRegex(templates[i].replaced));
        let replacement = templates[i].replacement;
        let flags = "";
        if (templates[i].globalMatch)
          flags += "g";
        if (!templates[i].sensitive)
          flags += "i";
        if (templates[i].word)
          replaced = RegExp(replaced.source.replace(/^/, "\\b").replace(/$/, "\\b"), flags);
        else
          replaced = RegExp(replaced.source, flags);
        mathLink = mathLink.replace(replaced, replacement);
      }
      return mathLink;
    });
  }
  updateBackLinks(file, mathLink) {
    return __async(this, null, function* () {
      let backLinkFilePaths = this.getBackLinkFilePaths(file);
      if (backLinkFilePaths.length != 0) {
        backLinkFilePaths.forEach((backLinkFilePath) => __async(this, null, function* () {
          let backLinkFile = this.app.vault.getAbstractFileByPath(backLinkFilePath);
          if (backLinkFile instanceof import_obsidian2.TFile && !isExcluded(backLinkFile, this.settings.excludedFilePaths)) {
            let backLinkFileContent = yield this.app.vault.read(backLinkFile);
            let modified = this.convertToMathLinks(file.name, backLinkFileContent, mathLink);
            if (backLinkFileContent != modified)
              this.app.vault.modify(backLinkFile, modified);
          }
        }));
      }
    });
  }
  removeBackMathLinks(file) {
    return __async(this, null, function* () {
      let backLinkFilePaths = this.getBackLinkFilePaths(file);
      if (backLinkFilePaths.length != 0) {
        backLinkFilePaths.forEach((backLinkFilePath) => __async(this, null, function* () {
          let backLinkFile = this.app.vault.getAbstractFileByPath(backLinkFilePath);
          if (backLinkFile instanceof import_obsidian2.TFile && !isExcluded(backLinkFile, this.settings.excludedFilePaths)) {
            let backLinkFileContent = yield this.app.vault.read(backLinkFile);
            let vaultPath = this.app.vault.getRoot().vault.adapter.basePath;
            let configDir = this.app.vault.configDir;
            let modified = "";
            let obsidianConfigFile = yield fs.readFile(`${vaultPath}/${configDir}/app.json`, "utf8", (err, data) => {
              if (JSON.parse(data).useMarkdownLinks)
                modified = this.convertToMarkdownLinks(file.name, backLinkFileContent);
              else
                modified = this.convertToDoubleLinks(file.name, backLinkFileContent);
              if (backLinkFileContent != modified)
                this.app.vault.modify(backLinkFile, modified);
            });
          }
        }));
      }
    });
  }
  updateOutLinks(file) {
    return __async(this, null, function* () {
      let fileContent = yield this.app.vault.read(file);
      let modified = fileContent;
      let count = 0;
      let outLinks = yield this.app.metadataCache.getFileCache(file).links;
      if (outLinks != void 0) {
        outLinks.forEach((outLink) => __async(this, null, function* () {
          let outLinkFileName = outLink.link;
          if (outLink.displayText != "")
            outLinkFileName = outLinkFileName.replace(/$/, ".md");
          let outLinkFilePath = this.app.fileManager.getNewFileParent(outLinkFileName).path + "/" + outLinkFileName;
          let outLinkFile = this.app.vault.getAbstractFileByPath(outLinkFilePath);
          if (outLinkFile instanceof import_obsidian2.TFile) {
            let outLinkMathLink = yield this.getMathLink(outLinkFile);
            if (outLinkMathLink != null)
              modified = this.convertToMathLinks(outLinkFileName, modified, outLinkMathLink[0]);
          }
          count++;
          if (count === outLinks.length && fileContent != modified)
            yield this.app.vault.modify(file, modified);
        }));
      }
    });
  }
  updateAutoNotes() {
    return __async(this, null, function* () {
      let allNotes = yield this.app.vault.getMarkdownFiles();
      let allIncludedNotes = getIncludedNotes(allNotes, this.settings.excludedFilePaths);
      allIncludedNotes.forEach((note) => __async(this, null, function* () {
        let mathLink = yield this.getMathLink(note);
        if (mathLink != null && mathLink[1])
          this.updateBackLinks(note, mathLink[0]);
        else
          this.removeBackMathLinks(note);
      }));
    });
  }
  getBackLinkFilePaths(file) {
    let backLinkFilePaths = [];
    Object.keys(this.app.metadataCache.resolvedLinks).forEach((key) => {
      let links = this.app.metadataCache.resolvedLinks[key];
      Object.keys(links).forEach((link) => {
        if (link === file.path)
          backLinkFilePaths.push(key);
      });
    });
    return backLinkFilePaths;
  }
  convertToMathLinks(fileName, fileContent, mathLink) {
    let left = mathLink.replace(/^/, "[").replace(/$/, "]");
    let right = fileName.replace(/^/, "(").replace(/$/, ")").replace(/\s/g, "%20");
    let newLink = `${left}${right}`;
    let mixedLink = new RegExp("\\[((?!\\]\\(|\\]\\]).)*\\]" + formatRegex(right), "g");
    let doubleLink = new RegExp(formatRegex(fileName.replace(/^/, "[[").replace(/\.md$/, "]]")), "g");
    return fileContent.replace(mixedLink, newLink).replace(doubleLink, newLink);
  }
  convertToDoubleLinks(fileName, fileContent) {
    let formattedName = fileName.replace(/^/, "(").replace(/$/, ")").replace(/\s/g, "%20");
    let mixedLink = new RegExp("\\[((?!\\]\\(|\\]\\]).)*\\]" + formatRegex(formattedName), "g");
    let doubleLink = fileName.replace(/^/, "[[").replace(/\.md$/, "]]");
    return fileContent.replace(mixedLink, doubleLink);
  }
  convertToMarkdownLinks(fileName, fileContent) {
    let formattedName = fileName.replace(/^/, "(").replace(/$/, ")").replace(/\s/g, "%20");
    let mixedLink = new RegExp("\\[((?!\\]\\(|\\]\\]).)*\\]" + formatRegex(formattedName), "g");
    let markdownLink = fileName.replace(/^/, "[").replace(/\.md$/, `]${formattedName}`);
    return fileContent.replace(mixedLink, markdownLink);
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy91dGlscy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTWF0aExpbmtzU2V0dGluZ3MsIE1hdGhMaW5rc1NldHRpbmdUYWIsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICcuL3NldHRpbmdzJztcbmltcG9ydCB7IGZvcm1hdFJlZ2V4LCBpc0V4Y2x1ZGVkLCBnZXRJbmNsdWRlZE5vdGVzIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hdGhMaW5rcyBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IE1hdGhMaW5rc1NldHRpbmdzO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IE1hdGhMaW5rc1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzO1xuXG4gICAgICAgIHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2NoYW5nZWQnLCBhc3luYyAoZmlsZTogVEZpbGUsIGRhdGE6IHN0cmluZywgY2FjaGU6IENhY2hlZE1ldGFEYXRhKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXNldHRpbmdzLmF1dG9VcGRhdGUgfHwgaXNFeGNsdWRlZChmaWxlLCBzZXR0aW5ncy5leGNsdWRlZEZpbGVQYXRocykpXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICAgIGxldCBtYXRoTGluayA9IGF3YWl0IHRoaXMuZ2V0TWF0aExpbmsoZmlsZSk7XG4gICAgICAgICAgICBpZiAobWF0aExpbmsgIT0gbnVsbClcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUJhY2tMaW5rcyhmaWxlLCBtYXRoTGlua1swXSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVCYWNrTWF0aExpbmtzKGZpbGUpO1xuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU91dExpbmtzKGZpbGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwidXBkYXRlX2FsbF9tYXRobGlua3NcIixcbiAgICAgICAgICAgIG5hbWU6IFwiVXBkYXRlIGFsbCBsaW5rc1wiLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgYWxsTm90ZXMgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgICAgICAgICAgbGV0IGFsbEluY2x1ZGVkTm90ZXMgPSBnZXRJbmNsdWRlZE5vdGVzKGFsbE5vdGVzLCBzZXR0aW5ncy5leGNsdWRlZEZpbGVQYXRocyk7XG4gICAgICAgICAgICAgICAgbGV0IHVwZGF0ZU5vdGljZSA9IG5ldyBOb3RpY2UoJ01hdGhMaW5rczogVXBkYXRpbmcuLi4nKTtcblxuICAgICAgICAgICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgYWxsSW5jbHVkZWROb3Rlcy5mb3JFYWNoKGFzeW5jIChub3RlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBtYXRoTGluayA9IGF3YWl0IHRoaXMuZ2V0TWF0aExpbmsobm90ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXRoTGluayAhPSBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVCYWNrTGlua3Mobm90ZSwgbWF0aExpbmtbMF0pO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUJhY2tNYXRoTGlua3Mobm90ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlTm90aWNlLnNldE1lc3NhZ2UoYE1hdGhMaW5rczogVXBkYXRpbmcuLi4gJHtjb3VudH0vJHthbGxJbmNsdWRlZE5vdGVzLmxlbmd0aH1gKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ID09PSBhbGxJbmNsdWRlZE5vdGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlTm90aWNlLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ01hdGhMaW5rczogVXBkYXRlZCBhbGwgbGlua3MnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRNYXRoTGluayhmaWxlOiBURmlsZSk6IFtzdHJpbmcsIGJvb2xlYW5dIHwgbnVsbCB7XG4gICAgICAgIGxldCBjb250ZW50cyA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgIGNvbnRlbnRzID0gY29udGVudHMuc3BsaXQoL1xccj9cXG4vKTtcblxuICAgICAgICBpZiAoY29udGVudHNbMF0gPT09ICctLS0nKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBsaW5lTnVtYmVyID0gMTsgbGluZU51bWJlciA8IGNvbnRlbnRzLmxlbmd0aDsgbGluZU51bWJlcisrKSB7XG4gICAgICAgICAgICAgICAgbGV0IGxpbmUgPSBjb250ZW50c1tsaW5lTnVtYmVyXTtcbiAgICAgICAgICAgICAgICBpZiAobGluZS5sZW5ndGggPCAxMCkge1xuICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyKys7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGtleSA9IGxpbmUuc3Vic3RyaW5nKDAsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ21hdGhMaW5rOiAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBsaW5lLnJlcGxhY2Uoa2V5LCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF0aExpbmsgPSBhd2FpdCB0aGlzLmdlbmVyYXRlTWF0aExpbmtGcm9tQXV0byhmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFttYXRoTGluaywgdHJ1ZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbdmFsdWUsIGZhbHNlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGluZSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcisrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGFzeW5jIGdlbmVyYXRlTWF0aExpbmtGcm9tQXV0byhmaWxlOiBUZmlsZSk6IHN0cmluZyB7XG4gICAgICAgIGxldCB0ZW1wbGF0ZXMgPSB0aGlzLnNldHRpbmdzLnRlbXBsYXRlcztcbiAgICAgICAgbGV0IG1hdGhMaW5rID0gZmlsZS5uYW1lLnJlcGxhY2UoJ1xcLm1kJywgJycpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRlbXBsYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IHJlcGxhY2VkID0gbmV3IFJlZ0V4cChmb3JtYXRSZWdleCh0ZW1wbGF0ZXNbaV0ucmVwbGFjZWQpKTtcbiAgICAgICAgICAgIGxldCByZXBsYWNlbWVudCA9IHRlbXBsYXRlc1tpXS5yZXBsYWNlbWVudDtcblxuICAgICAgICAgICAgbGV0IGZsYWdzID0gJyc7XG4gICAgICAgICAgICBpZiAodGVtcGxhdGVzW2ldLmdsb2JhbE1hdGNoKVxuICAgICAgICAgICAgICAgIGZsYWdzICs9ICdnJztcbiAgICAgICAgICAgIGlmICghdGVtcGxhdGVzW2ldLnNlbnNpdGl2ZSlcbiAgICAgICAgICAgICAgICBmbGFncyArPSAnaSc7XG5cbiAgICAgICAgICAgIGlmICh0ZW1wbGF0ZXNbaV0ud29yZClcbiAgICAgICAgICAgICAgICByZXBsYWNlZCA9IFJlZ0V4cChyZXBsYWNlZC5zb3VyY2UucmVwbGFjZSgvXi8sICdcXFxcYicpLnJlcGxhY2UoLyQvLCAnXFxcXGInKSwgZmxhZ3MpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJlcGxhY2VkID0gUmVnRXhwKHJlcGxhY2VkLnNvdXJjZSwgZmxhZ3MpO1xuXG4gICAgICAgICAgICBtYXRoTGluayA9IG1hdGhMaW5rLnJlcGxhY2UocmVwbGFjZWQsIHJlcGxhY2VtZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF0aExpbms7XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlQmFja0xpbmtzKGZpbGU6IFRGaWxlLCBtYXRoTGluazogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGxldCBiYWNrTGlua0ZpbGVQYXRocyA9IHRoaXMuZ2V0QmFja0xpbmtGaWxlUGF0aHMoZmlsZSk7XG4gICAgICAgIGlmIChiYWNrTGlua0ZpbGVQYXRocy5sZW5ndGggIT0gMCkge1xuICAgICAgICAgICAgYmFja0xpbmtGaWxlUGF0aHMuZm9yRWFjaChhc3luYyAoYmFja0xpbmtGaWxlUGF0aCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBiYWNrTGlua0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYmFja0xpbmtGaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKGJhY2tMaW5rRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmICFpc0V4Y2x1ZGVkKGJhY2tMaW5rRmlsZSwgdGhpcy5zZXR0aW5ncy5leGNsdWRlZEZpbGVQYXRocykpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGJhY2tMaW5rRmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGJhY2tMaW5rRmlsZSk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBtb2RpZmllZCA9IHRoaXMuY29udmVydFRvTWF0aExpbmtzKGZpbGUubmFtZSwgYmFja0xpbmtGaWxlQ29udGVudCwgbWF0aExpbmspO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChiYWNrTGlua0ZpbGVDb250ZW50ICE9IG1vZGlmaWVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGJhY2tMaW5rRmlsZSwgbW9kaWZpZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgcmVtb3ZlQmFja01hdGhMaW5rcyhmaWxlOiBURmlsZSk6IHZvaWQge1xuICAgICAgICBsZXQgYmFja0xpbmtGaWxlUGF0aHMgPSB0aGlzLmdldEJhY2tMaW5rRmlsZVBhdGhzKGZpbGUpO1xuICAgICAgICBpZiAoYmFja0xpbmtGaWxlUGF0aHMubGVuZ3RoICE9IDApIHtcbiAgICAgICAgICAgIGJhY2tMaW5rRmlsZVBhdGhzLmZvckVhY2goYXN5bmMgKGJhY2tMaW5rRmlsZVBhdGgpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgYmFja0xpbmtGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGJhY2tMaW5rRmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgIGlmIChiYWNrTGlua0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiAhaXNFeGNsdWRlZChiYWNrTGlua0ZpbGUsIHRoaXMuc2V0dGluZ3MuZXhjbHVkZWRGaWxlUGF0aHMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBiYWNrTGlua0ZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChiYWNrTGlua0ZpbGUpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgdmF1bHRQYXRoID0gdGhpcy5hcHAudmF1bHQuZ2V0Um9vdCgpLnZhdWx0LmFkYXB0ZXIuYmFzZVBhdGg7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb25maWdEaXIgPSB0aGlzLmFwcC52YXVsdC5jb25maWdEaXI7XG4gICAgICAgICAgICAgICAgICAgIGxldCBtb2RpZmllZCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBsZXQgb2JzaWRpYW5Db25maWdGaWxlID0gYXdhaXQgZnMucmVhZEZpbGUoYCR7dmF1bHRQYXRofS8ke2NvbmZpZ0Rpcn0vYXBwLmpzb25gLCAndXRmOCcsIChlcnIsIGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChKU09OLnBhcnNlKGRhdGEpLnVzZU1hcmtkb3duTGlua3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZWQgPSB0aGlzLmNvbnZlcnRUb01hcmtkb3duTGlua3MoZmlsZS5uYW1lLCBiYWNrTGlua0ZpbGVDb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RpZmllZCA9IHRoaXMuY29udmVydFRvRG91YmxlTGlua3MoZmlsZS5uYW1lLCBiYWNrTGlua0ZpbGVDb250ZW50KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJhY2tMaW5rRmlsZUNvbnRlbnQgIT0gbW9kaWZpZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGJhY2tMaW5rRmlsZSwgbW9kaWZpZWQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZU91dExpbmtzKGZpbGU6IFRGaWxlKTogdm9pZCB7XG4gICAgICAgIGxldCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgIGxldCBtb2RpZmllZCA9IGZpbGVDb250ZW50O1xuXG4gICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgIGxldCBvdXRMaW5rcyA9IGF3YWl0IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpLmxpbmtzO1xuICAgICAgICBpZiAob3V0TGlua3MgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvdXRMaW5rcy5mb3JFYWNoKGFzeW5jIChvdXRMaW5rKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IG91dExpbmtGaWxlTmFtZSA9IG91dExpbmsubGluaztcbiAgICAgICAgICAgICAgICBpZiAob3V0TGluay5kaXNwbGF5VGV4dCAhPSBcIlwiKVxuICAgICAgICAgICAgICAgICAgICBvdXRMaW5rRmlsZU5hbWUgPSBvdXRMaW5rRmlsZU5hbWUucmVwbGFjZSgvJC8sICcubWQnKTtcblxuICAgICAgICAgICAgICAgIGxldCBvdXRMaW5rRmlsZVBhdGggPSB0aGlzLmFwcC5maWxlTWFuYWdlci5nZXROZXdGaWxlUGFyZW50KG91dExpbmtGaWxlTmFtZSkucGF0aCArICcvJyArIG91dExpbmtGaWxlTmFtZTtcbiAgICAgICAgICAgICAgICBsZXQgb3V0TGlua0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgob3V0TGlua0ZpbGVQYXRoKTtcblxuICAgICAgICAgICAgICAgIGlmIChvdXRMaW5rRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBvdXRMaW5rTWF0aExpbmsgPSBhd2FpdCB0aGlzLmdldE1hdGhMaW5rKG91dExpbmtGaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG91dExpbmtNYXRoTGluayAhPSBudWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kaWZpZWQgPSB0aGlzLmNvbnZlcnRUb01hdGhMaW5rcyhvdXRMaW5rRmlsZU5hbWUsIG1vZGlmaWVkLCBvdXRMaW5rTWF0aExpbmtbMF0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50ID09PSBvdXRMaW5rcy5sZW5ndGggJiYgZmlsZUNvbnRlbnQgIT0gbW9kaWZpZWQpXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBtb2RpZmllZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZUF1dG9Ob3RlcygpOiB2b2lkIHtcbiAgICAgICAgbGV0IGFsbE5vdGVzID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICBsZXQgYWxsSW5jbHVkZWROb3RlcyA9IGdldEluY2x1ZGVkTm90ZXMoYWxsTm90ZXMsIHRoaXMuc2V0dGluZ3MuZXhjbHVkZWRGaWxlUGF0aHMpO1xuICAgICAgICBhbGxJbmNsdWRlZE5vdGVzLmZvckVhY2goYXN5bmMgKG5vdGUpID0+IHtcbiAgICAgICAgICAgIGxldCBtYXRoTGluayA9IGF3YWl0IHRoaXMuZ2V0TWF0aExpbmsobm90ZSk7XG4gICAgICAgICAgICBpZiAobWF0aExpbmsgIT0gbnVsbCAmJiBtYXRoTGlua1sxXSlcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUJhY2tMaW5rcyhub3RlLCBtYXRoTGlua1swXSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVCYWNrTWF0aExpbmtzKG5vdGUpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRCYWNrTGlua0ZpbGVQYXRocyhmaWxlOiBUZmlsZSk6IHN0cmluZ1tdIHtcbiAgICAgICAgbGV0IGJhY2tMaW5rRmlsZVBhdGhzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLnJlc29sdmVkTGlua3MpLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgbGV0IGxpbmtzID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5yZXNvbHZlZExpbmtzW2tleV07XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhsaW5rcykuZm9yRWFjaCgobGluaykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsaW5rID09PSBmaWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgIGJhY2tMaW5rRmlsZVBhdGhzLnB1c2goa2V5KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYmFja0xpbmtGaWxlUGF0aHM7XG4gICAgfVxuXG4gICAgY29udmVydFRvTWF0aExpbmtzKGZpbGVOYW1lOiBzdHJpbmcsIGZpbGVDb250ZW50OiBzdHJpbmcsIG1hdGhMaW5rOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgbGVmdCA9IG1hdGhMaW5rLnJlcGxhY2UoL14vLCAnWycpLnJlcGxhY2UoLyQvLCAnXScpO1xuICAgICAgICBsZXQgcmlnaHQgPSBmaWxlTmFtZS5yZXBsYWNlKC9eLywgJygnKS5yZXBsYWNlKC8kLywgJyknKS5yZXBsYWNlKC9cXHMvZywgJyUyMCcpO1xuICAgICAgICBsZXQgbmV3TGluayA9IGAke2xlZnR9JHtyaWdodH1gO1xuXG4gICAgICAgIGxldCBtaXhlZExpbmsgPSBuZXcgUmVnRXhwKCdcXFxcWygoPyFcXFxcXVxcXFwofFxcXFxdXFxcXF0pLikqXFxcXF0nICsgZm9ybWF0UmVnZXgocmlnaHQpLCAnZycpO1xuICAgICAgICBsZXQgZG91YmxlTGluayA9IG5ldyBSZWdFeHAoZm9ybWF0UmVnZXgoZmlsZU5hbWUucmVwbGFjZSgvXi8sICdcXFtcXFsnKS5yZXBsYWNlKC9cXC5tZCQvLCAnXFxdXFxdJykpLCAnZycpO1xuXG4gICAgICAgIHJldHVybiBmaWxlQ29udGVudC5yZXBsYWNlKG1peGVkTGluaywgbmV3TGluaykucmVwbGFjZShkb3VibGVMaW5rLCBuZXdMaW5rKTtcbiAgICB9XG5cbiAgICBjb252ZXJ0VG9Eb3VibGVMaW5rcyhmaWxlTmFtZTogc3RyaW5nLCBmaWxlQ29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IGZvcm1hdHRlZE5hbWUgPSBmaWxlTmFtZS5yZXBsYWNlKC9eLywgJygnKS5yZXBsYWNlKC8kLywgJyknKS5yZXBsYWNlKC9cXHMvZywgJyUyMCcpO1xuXG4gICAgICAgIGxldCBtaXhlZExpbmsgPSBuZXcgUmVnRXhwKCdcXFxcWygoPyFcXFxcXVxcXFwofFxcXFxdXFxcXF0pLikqXFxcXF0nICsgZm9ybWF0UmVnZXgoZm9ybWF0dGVkTmFtZSksICdnJyk7XG4gICAgICAgIGxldCBkb3VibGVMaW5rID0gZmlsZU5hbWUucmVwbGFjZSgvXi8sICdbWycpLnJlcGxhY2UoL1xcLm1kJC8sICddXScpO1xuXG4gICAgICAgIHJldHVybiBmaWxlQ29udGVudC5yZXBsYWNlKG1peGVkTGluaywgZG91YmxlTGluayk7XG4gICAgfVxuXG4gICAgY29udmVydFRvTWFya2Rvd25MaW5rcyhmaWxlTmFtZTogc3RyaW5nLCBmaWxlQ29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IGZvcm1hdHRlZE5hbWUgPSBmaWxlTmFtZS5yZXBsYWNlKC9eLywgJygnKS5yZXBsYWNlKC8kLywgJyknKS5yZXBsYWNlKC9cXHMvZywgJyUyMCcpO1xuXG4gICAgICAgIGxldCBtaXhlZExpbmsgPSBuZXcgUmVnRXhwKCdcXFxcWygoPyFcXFxcXVxcXFwofFxcXFxdXFxcXF0pLikqXFxcXF0nICsgZm9ybWF0UmVnZXgoZm9ybWF0dGVkTmFtZSksICdnJyk7XG4gICAgICAgIGxldCBtYXJrZG93bkxpbmsgPSBmaWxlTmFtZS5yZXBsYWNlKC9eLywgJ1snKS5yZXBsYWNlKC9cXC5tZCQvLCBgXSR7Zm9ybWF0dGVkTmFtZX1gKTtcblxuICAgICAgICByZXR1cm4gZmlsZUNvbnRlbnQucmVwbGFjZShtaXhlZExpbmssIG1hcmtkb3duTGluayk7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFNldHRpbmcsIFBsdWdpblNldHRpbmdUYWIsIE1vZGFsLCBUZXh0Q29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgTm90aWNlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGludGVyZmFjZSBNYXRoTGlua3NTZXR0aW5ncyB7XG4gICAgdGVtcGxhdGVzOiBzdHJpbmdbXTtcbiAgICBleGNsdWRlZEZpbGVQYXRoczogc3RyaW5nW107XG4gICAgYXV0b1VwZGF0ZTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE1hdGhMaW5rc1NldHRpbmdzID0ge1xuICAgIHRlbXBsYXRlczogW10sXG4gICAgZXhjbHVkZWRGaWxlUGF0aHM6IFtdLFxuICAgIGF1dG9VcGRhdGU6IHRydWVcbn1cblxuZXhwb3J0IGNsYXNzIE1hdGhMaW5rc1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IE1hdGhMaW5rcztcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE1hdGhMaW5rcykge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGFzeW5jIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdNYXRoTGlua3MgU2V0dGluZ3MnfSk7XG5cbiAgICAgICAgLy8gVXBkYXRlIHdoZW4gbW9kaWZpZWRcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnVXBkYXRlIHdoZW4gbW9kaWZpZWQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0F1dG9tYXRpY2FsbHkgdXBkYXRlIGxpbmtzIGluIHRoZSBjdXJyZW50IGZpbGUgd2hlbiBtb2RpZmllZC4nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7dG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9VcGRhdGUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jIChjdXJyZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9VcGRhdGUgPSBjdXJyZW50O1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFkZCBhIG5ldyB0ZW1wbGF0ZVxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdBZGQgYSBuZXcgdGVtcGxhdGUnKVxuICAgICAgICAgICAgLnNldERlc2MoXG4gICAgICAgICAgICAgICAgY3JlYXRlRnJhZ21lbnQoKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZS5jcmVhdGVTcGFuKHt0ZXh0OiAnR2VuZXJhdGUgbWF0aExpbmtzIHdpdGggYSBuZXcgdGVtcGxhdGUuIFVzZSAnfSk7XG4gICAgICAgICAgICAgICAgICAgIGUuY3JlYXRlRWwoJ2NvZGUnLCB7dGV4dDogJ21hdGhMaW5rOiBhdXRvJ30pO1xuICAgICAgICAgICAgICAgICAgICBlLmNyZWF0ZVNwYW4oe3RleHQ6ICcgdG8gdXNlIHRlbXBsYXRlcyBpbiBhIGZpbGUuJ30pO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuYWRkQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGIgPSBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ0FkZCcpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdwbHVzJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IEFkZFRlbXBsYXRlc01vZGFsKHRoaXMuYXBwLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vbkNsb3NlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RhbC5zYXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBtb2RhbC50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VkOiBtb2RhbC5yZXBsYWNlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50OiBtb2RhbC5yZXBsYWNlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbE1hdGNoOiBtb2RhbC5nbG9iYWxNYXRjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnNpdGl2ZTogbW9kYWwuc2Vuc2l0aXZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29yZDogbW9kYWwud29yZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlcy5wdXNoKHRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUF1dG9Ob3RlcygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ01hdGhMaW5rczogVGVtcGxhdGUgYWRkZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBFZGl0L2RlbGV0ZSB0ZW1wbGF0ZVxuICAgICAgICBsZXQgdGVtcGxhdGVUaXRsZTogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRWRpdC9kZWxldGUgdGVtcGxhdGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1NlbGVjdCBhIHRlbXBsYXRlIHRvIGVkaXQvZGVsZXRlIGl0LicpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duOiBEcm9wZG93bkNvbXBvbmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbignX19zZWxlY3QnLCAnU2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVzLmZvckVhY2goKHRlbXBsYXRlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbih0ZW1wbGF0ZS50aXRsZSwgdGVtcGxhdGUudGl0bGUpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoYXN5bmMgKGN1cnJlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgIT0gJ19fc2VsZWN0JylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVGl0bGUgPSBjdXJyZW50O1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuYWRkRXh0cmFCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgYiA9IGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnRWRpdCcpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdlZGl0JylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXBsYXRlVGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb3JpZ2luYWxUZW1wbGF0ZXMgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtb2RhbCA9IG5ldyBFZGl0VGVtcGxhdGVzTW9kYWwodGhpcy5hcHAsIHRlbXBsYXRlVGl0bGUsIHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vbkNsb3NlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kYWwuc2F2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlQXV0b05vdGVzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ01hdGhMaW5rczogVGVtcGxhdGUgc2F2ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlcyA9IG9yaWdpbmFsVGVtcGxhdGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnTWF0aExpbmtzOiBQbGVhc2Ugc2VsZWN0IGEgdGVtcGxhdGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmFkZEV4dHJhQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGIgPSBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ0RlbGV0ZScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCd0cmFzaCcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZVRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IERlbGV0ZU1vZGFsKHRoaXMuYXBwLCBgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSAnJHt0ZW1wbGF0ZVRpdGxlfSc/YCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vbkNsb3NlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kYWwuc2F2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnRlbXBsYXRlc1tpXS50aXRsZSA9PT0gdGVtcGxhdGVUaXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50ZW1wbGF0ZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTWF0aExpbmtzOiBUZW1wbGF0ZSAnJHt0ZW1wbGF0ZVRpdGxlfScgZGVsZXRlZGApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdNYXRoTGlua3M6IFBsZWFzZSBzZWxlY3QgYSB0ZW1wbGF0ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYjtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFkZCBhbiBleGNsdWRlZCBmaWxlXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0FkZCBhbiBleGNsdWRlZCBmaWxlJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdNYXRoTGlua3Mgd2lsbCBpZ25vcmUgdGhvc2UgZmlsZXMuJylcbiAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgYiA9IGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnQWRkJylcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ3BsdXMnKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbW9kYWwgPSBuZXcgQWRkRXhjbHVkZWRNb2RhbCh0aGlzLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZWRGaWxlUGF0aHMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vbkNsb3NlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RhbC5zYXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGNsdWRlZEZpbGVQYXRoID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogbW9kYWwuZXhjbHVkZWRGaWxlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRmlsZTogbW9kYWwuaXNGaWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlZEZpbGVQYXRocy5wdXNoKGV4Y2x1ZGVkRmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kYWwuaXNGaWxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnTWF0aExpbmtzOiBGaWxlIGV4Y2x1ZGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ01hdGhMaW5rczogUGF0aCBleGNsY3VkZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGI7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZW1vdmUgZnJvbSBleGNsdWRlZCBmaWxlc1xuICAgICAgICBsZXQgZXhjbHVkZWRGaWxlUGF0aDogc3RyaW5nIHwgbnVsbDtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVtb3ZlIGZyb20gZXhjbHVkZWQgZmlsZXMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1JlbW92ZSBhIGZpbGUgZnJvbSB0aGUgbGlzdCBvZiBleGNsdWRlZCBmaWxlcy4nKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGFzeW5jIChkcm9wZG93bjogRHJvcGRvd25Db21wb25lbnQpID0+IHtcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oJ19fc2VsZWN0JywgJ1NlbGVjdCcpO1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGVkRmlsZVBhdGhzLmZvckVhY2goKGV4Y2x1ZGVkRmlsZVBhdGgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKGV4Y2x1ZGVkRmlsZVBhdGgucGF0aCwgZXhjbHVkZWRGaWxlUGF0aC5wYXRoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jIChjdXJyZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50ICE9ICdfX3NlbGVjdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlZEZpbGVQYXRoID0gY3VycmVudDtcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZWRGaWxlUGF0aCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmFkZEV4dHJhQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGIgPSBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1JlbW92ZScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCd0cmFzaCcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGNsdWRlZEZpbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IERlbGV0ZU1vZGFsKHRoaXMuYXBwLCBgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIHJlbW92ZSAnJHtleGNsdWRlZEZpbGVQYXRofScgZnJvbSB0aGUgbGlzdCBvZiBleGNsdWRlZCBmaWxlcy9wYXRocz9gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLm9uQ2xvc2UgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RhbC5zYXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlZEZpbGVQYXRocy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlZEZpbGVQYXRoc1tpXS5wYXRoID09PSBleGNsdWRlZEZpbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGVkRmlsZVBhdGhzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYE1hdGhMaW5rczogJyR7ZXhjbHVkZWRGaWxlUGF0aH0nIHJlbW92ZWQgZnJvbSBleGNsdWRlZCBmaWxlc2ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdNYXRoTGlua3M6IFBsZWFzZSBzZWxlY3QgYSBmaWxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxufVxuXG5jbGFzcyBBZGRUZW1wbGF0ZXNNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGVycm9yOiBzdHJpbmdbXSA9IFsnTWF0aExpbmtzOiBQbGVhc2UgZW50ZXIgYSB0aXRsZScsICdNYXRoTGlua3M6IFBsZWFzZSBlbnRlciBhIG5vbi1lbXB0eSBzdHJpbmcgdG8gYmUgcmVwbGFjZWQnXTtcblxuICAgIHRpdGxlOiBzdHJpbmcgPSAnJztcbiAgICByZXBsYWNlZDogc3RyaW5nID0gJyc7XG4gICAgcmVwbGFjZW1lbnQ6IHN0cmluZyA9ICcnO1xuICAgIGdsb2JhbE1hdGNoOiBib29sZWFuID0gdHJ1ZTtcbiAgICBzZW5zaXRpdmU6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHdvcmQ6IGJvb2xlYW4gPSB0cnVlXG5cbiAgICB0ZW1wbGF0ZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGVtcGxhdGVzOiBzdHJpbmdbXSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnRlbXBsYXRlcyA9IHRlbXBsYXRlcztcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgICAgICBsb2FkVGVtcGxhdGVTZXR0aW5ncyhjb250ZW50RWwsIHRoaXMsIHRoaXMsICdhZGQnKTtcbiAgICAgICAgbG9hZEJ1dHRvbnNUb0Nsb3NlKHRoaXMsIHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpLCAnQWRkJywgJ0NhbmNlbCcpO1xuICAgIH1cbn1cblxuY2xhc3MgRWRpdFRlbXBsYXRlc01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHNhdmVkOiBib29sZWFuID0gZmFsc2U7XG4gICAgZXJyb3I6IHN0cmluZ1tdID0gWycnLCAnJ107XG5cbiAgICB0ZW1wbGF0ZVRpdGxlOiBzdHJpbmc7XG4gICAgdGVtcGxhdGVzOiBzdHJpbmdbXTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCB0ZW1wbGF0ZVRpdGxlOiBzdHJpbmcsIHRlbXBsYXRlczogc3RyaW5nW10pIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZVRpdGxlID0gdGVtcGxhdGVUaXRsZTtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZXMgPSB0ZW1wbGF0ZXM7XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG5cbiAgICAgICAgdGhpcy50ZW1wbGF0ZXMuZXZlcnkoKHRlbXBsYXRlKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy50ZW1wbGF0ZVRpdGxlICE9IHVuZGVmaW5lZCAmJiB0ZW1wbGF0ZS50aXRsZSA9PSB0aGlzLnRlbXBsYXRlVGl0bGUpIHtcbiAgICAgICAgICAgICAgICBsb2FkVGVtcGxhdGVTZXR0aW5ncyhjb250ZW50RWwsIHRlbXBsYXRlLCB0aGlzLCAnZWRpdCcpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcblxuICAgICAgICBsb2FkQnV0dG9uc1RvQ2xvc2UodGhpcywgdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCksICdTYXZlJywgJ0NhbmNlbCcpO1xuICAgIH1cbn1cblxuY2xhc3MgQWRkRXhjbHVkZWRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGVycm9yOiBzdHJpbmdbXSA9IFsnTWF0aExpbmtzOiBQbGVhc2UgZW50ZXIgYSB2YWxpZCBmaWxlL3BhdGgnLCAnJ107XG5cbiAgICBleGNsdWRlZEZpbGVQYXRoOiBzdHJpbmc7XG4gICAgaXNGaWxlOiBib29sZWFuO1xuXG4gICAgZXhjbHVkZWRGaWxlUGF0aHM6IHN0cmluZ1tdO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGV4Y2x1ZGVkRmlsZVBhdGhzOiBzdHJpbmdbXSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLmV4Y2x1ZGVkRmlsZVBhdGhzID0gZXhjbHVkZWRGaWxlUGF0aHM7XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG5cbiAgICAgICAgbGV0IGV4Y2x1ZGVkRmlsZVBhdGhUZXh0OiBUZXh0Q29tcG9uZW50O1xuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRmlsZSBuYW1lL3BhdGggb2YgZm9sZGVyJylcbiAgICAgICAgICAgIC5zZXREZXNjKFxuICAgICAgICAgICAgICAgIGNyZWF0ZUZyYWdtZW50KChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGUuY3JlYXRlU3Bhbih7dGV4dDogJ0VudGVyIGEgZmlsZSBhcyd9KTtcbiAgICAgICAgICAgICAgICAgICAgZS5jcmVhdGVFbCgnY29kZScsIHt0ZXh0OiAncGF0aC9uYW1lLm1kJ30pO1xuICAgICAgICAgICAgICAgICAgICBlLmNyZWF0ZVNwYW4oe3RleHQ6ICcgYW5kIGEgZm9sZGVyIGFzICd9KTtcbiAgICAgICAgICAgICAgICAgICAgZS5jcmVhdGVFbCgnY29kZScsIHt0ZXh0OiAncGF0aCd9KTtcbiAgICAgICAgICAgICAgICAgICAgZS5jcmVhdGVTcGFuKHt0ZXh0OiAnLid9KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHtcbiAgICAgICAgICAgICAgICBleGNsdWRlZEZpbGVQYXRoVGV4dCA9IHRleHQ7XG4gICAgICAgICAgICAgICAgbGV0IGZvb3RlckVsID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgICAgICAgICAgbG9hZEJ1dHRvbnNUb0Nsb3NlKHRoaXMsIGZvb3RlckVsLCAnQWRkJywgJ0NhbmNlbCcpO1xuICAgICAgICAgICAgICAgIGV4Y2x1ZGVkRmlsZVBhdGhUZXh0XG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgoY3VycmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbGUgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGN1cnJlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXhjbHVkZWRGaWxlUGF0aCA9IGZpbGUucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRmlsZSA9IGZpbGUgaW5zdGFuY2VvZiBURmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yWzBdID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JbMF0gPSAnTWF0aExpbmtzOiBQbGVhc2UgZW50ZXIgYSB2YWxpZCBmaWxlL3BhdGgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yWzFdID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4Y2x1ZGVkRmlsZVBhdGhzLmV2ZXJ5KChwYXRoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhdGgucGF0aCA9PSBjdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JbMV0gPSAnTWF0aExpbmtzOiBEdXBsaWNhdGUgZmlsZS9wYXRoJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb290ZXJFbC5lbXB0eSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEJ1dHRvbnNUb0Nsb3NlKHRoaXMsIGZvb3RlckVsLCAnQWRkJywgJ0NhbmNlbCcpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1cblxuY2xhc3MgRGVsZXRlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgc2F2ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGFyZVlvdVN1cmU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBhcmVZb3VTdXJlOiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hcmVZb3VTdXJlID0gYXJlWW91U3VyZTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gzJywge3RleHQ6IHRoaXMuYXJlWW91U3VyZX0pO1xuICAgICAgICBsb2FkQnV0dG9uc1RvQ2xvc2UodGhpcywgdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCksICdZZXMnLCAnTm8nKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGxvYWRUZW1wbGF0ZVNldHRpbmdzKGNvbnRlbnRFbDogSFRNTEVsZW1lbnQsIHRlbXBsYXRlOiBzdHJpbmcsIG1vZGFsOiBNb2RhbCwgbW9kYWxUeXBlOiBzdHJpbmcpIHtcbiAgICBsZXQgdGl0bGVUZXh0OiBUZXh0Q29tcG9uZW50O1xuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgLnNldE5hbWUoJ1RpdGxlJylcbiAgICAgICAgLnNldERlc2MoJ05hbWUgb2YgdGhlIHRlbXBsYXRlLicpXG4gICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICB0aXRsZVRleHQgPSB0ZXh0O1xuICAgICAgICAgICAgdGl0bGVUZXh0LnNldFZhbHVlKHRlbXBsYXRlLnRpdGxlKS5vbkNoYW5nZSgoY3VycmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlLnRpdGxlID0gY3VycmVudDtcbiAgICAgICAgICAgICAgICBtb2RhbC5lcnJvclswXSA9ICcnO1xuICAgICAgICAgICAgICAgIGlmIChtb2RhbFR5cGUgPT09ICdhZGQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlLnRlbXBsYXRlcy5ldmVyeSgodGVtcGxhdGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZS50aXRsZSAhPSAnJyAmJiB0ZW1wbGF0ZS50aXRsZSA9PSB0ZW1wbGF0ZS50aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLmVycm9yWzBdID0gJ01hdGhMaW5rczogRHVwbGljYXRlIHRpdGxlJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0ZW1wbGF0ZS50aXRsZSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwuZXJyb3JbMF0gPSAnTWF0aExpbmtzOiBQbGVhc2UgZW50ZXIgYSB0aXRsZSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgbGV0IHJlcGxhY2VkVGV4dDogVGV4dENvbXBvbmVudDtcbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgIC5zZXROYW1lKCdNYXRjaCBmb3IuLi4nKVxuICAgICAgICAuc2V0RGVzYygnU3RyaW5nIHRvIGJlIG1hdGNoZWQgYW5kIHJlcGxhY2VkLiBEbyBub3QgaW5jbHVkZSByZWdleC4nKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4ge1xuICAgICAgICAgICAgcmVwbGFjZWRUZXh0ID0gdGV4dDtcbiAgICAgICAgICAgIHJlcGxhY2VkVGV4dC5zZXRWYWx1ZSh0ZW1wbGF0ZS5yZXBsYWNlZCkub25DaGFuZ2UoKGN1cnJlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZS5yZXBsYWNlZCA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgbW9kYWwuZXJyb3JbMV0gPSAnJztcbiAgICAgICAgICAgICAgICBpZiAodGVtcGxhdGUucmVwbGFjZWQgPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwuZXJyb3JbMV0gPSAnTWF0aExpbmtzOiBQbGVhc2UgZW50ZXIgYSBub24tZW1wdHkgc3RyaW5nIHRvIGJlIHJlcGxhY2VkJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgIGxldCByZXBsYWNlbWVudFRleHQ6IFRleHRDb21wb25lbnQ7XG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAuc2V0TmFtZSgnUmVwbGFjZSB3aXRoLi4uJylcbiAgICAgICAgLnNldERlc2MoJ1N0cmluZyB0byByZXBsYWNlIG1hdGNoZXMuIERvIG5vdCBlc2NhcGUgYmFja3NsYXNoZXMuJylcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHtcbiAgICAgICAgICAgIHJlcGxhY2VtZW50VGV4dCA9IHRleHQ7XG4gICAgICAgICAgICByZXBsYWNlbWVudFRleHQuc2V0VmFsdWUodGVtcGxhdGUucmVwbGFjZW1lbnQpLm9uQ2hhbmdlKChjdXJyZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGUucmVwbGFjZW1lbnQgPSBjdXJyZW50O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAuc2V0TmFtZSgnR2xvYmFsIG1hdGNoJylcbiAgICAgICAgLnNldERlc2MoJ01hdGNoIGFsbCBpbnN0YW5jZXMgKGluc3RlYWQgb2YganVzdCB0aGUgZmlyc3QpLicpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xuICAgICAgICAgICAgdG9nZ2xlLnNldFZhbHVlKHRlbXBsYXRlLmdsb2JhbE1hdGNoKS5vbkNoYW5nZSgoY3VycmVudCkgPT4gKHRlbXBsYXRlLmdsb2JhbE1hdGNoID0gY3VycmVudCkpO1xuICAgICAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgLnNldE5hbWUoJ0Nhc2Ugc2Vuc2l0aXZlJylcbiAgICAgICAgLnNldERlc2MoJ01hdGNoZXMgd2lsbCBiZSBjYXNlIHNlbnNpdGl2ZS4nKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcbiAgICAgICAgICAgIHRvZ2dsZS5zZXRWYWx1ZSh0ZW1wbGF0ZS5zZW5zaXRpdmUpLm9uQ2hhbmdlKChjdXJyZW50KSA9PiAodGVtcGxhdGUuc2Vuc2l0aXZlID0gY3VycmVudCkpO1xuICAgICAgICB9KTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgLnNldE5hbWUoJ01hdGNoIHdob2xlIHdvcmRzJylcbiAgICAgICAgLnNldERlc2MoJ09ubHkgbWF0Y2ggd2hvbGUgd29yZHMuJylcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XG4gICAgICAgICAgICB0b2dnbGUuc2V0VmFsdWUodGVtcGxhdGUud29yZCkub25DaGFuZ2UoKGN1cnJlbnQpID0+ICh0ZW1wbGF0ZS53b3JkID0gY3VycmVudCkpO1xuICAgICAgICB9KTtcbn1cblxuZnVuY3Rpb24gbG9hZEJ1dHRvbnNUb0Nsb3NlKG1vZGFsOiBNb2RhbCwgZWxlbWVudDogSFRNTEVsZW1lbnQsIHRydWVUb29sVGlwOiBzdHJpbmcsIGZhbHNlVG9vbFRpcDogc3RyaW5nKSB7XG4gICAgbGV0IGZvb3RlckJ1dHRvbnMgPSBuZXcgU2V0dGluZyhlbGVtZW50KTtcbiAgICBmb290ZXJCdXR0b25zLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICBiLnNldFRvb2x0aXAodHJ1ZVRvb2xUaXApXG4gICAgICAgICAgICAuc2V0SWNvbignY2hlY2ttYXJrJylcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgcHJvY2VlZCA9IG1vZGFsLmVycm9yLmV2ZXJ5KChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IgIT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgaWYgKCFwcm9jZWVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLmVycm9yLmZvckVhY2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IgIT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5zYXZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgZm9vdGVyQnV0dG9ucy5hZGRFeHRyYUJ1dHRvbigoYikgPT4ge1xuICAgICAgICBiLnNldFRvb2x0aXAoZmFsc2VUb29sVGlwKVxuICAgICAgICAgICAgLnNldEljb24oJ2Nyb3NzJylcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBtb2RhbC5zYXZlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFJlZ2V4KHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gc3RyXG4gICAgICAgIC5yZXBsYWNlKC9cXHMvZywgJ1xcXFxzJylcbiAgICAgICAgLnJlcGxhY2UoL1xcLi9nLCAnXFxcXC4nKVxuICAgICAgICAucmVwbGFjZSgvXFwoL2csICdcXFxcKCcpXG4gICAgICAgIC5yZXBsYWNlKC9cXCkvZywgJ1xcXFwpJylcbiAgICAgICAgLnJlcGxhY2UoL1xcey9nLCAnXFxcXHsnKVxuICAgICAgICAucmVwbGFjZSgvXFx9L2csICdcXFxcfScpXG4gICAgICAgIC5yZXBsYWNlKC9cXFsvZywgJ1xcXFxbJylcbiAgICAgICAgLnJlcGxhY2UoL1xcXS9nLCAnXFxcXF0nKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRXhjbHVkZWQoZmlsZTogVEZpbGUsIGV4Y2x1ZGVkRmlsZVBhdGhzOiBzdHJpbmdbXSk6IGJvb2xlYW4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXhjbHVkZWRGaWxlUGF0aHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IHBhdGggPSBleGNsdWRlZEZpbGVQYXRoc1tpXTtcbiAgICAgICAgaWYgKHBhdGguaXNGaWxlICYmIGZpbGUucGF0aCA9PT0gcGF0aC5wYXRoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmICghcGF0aC5pc0ZpbGUpIHtcbiAgICAgICAgICAgIGxldCBwYXRoUmVnZXggPSBuZXcgUmVnRXhwKGBcXFxcYiR7cGF0aC5wYXRofS9gKTtcbiAgICAgICAgICAgIGlmIChwYXRoUmVnZXgudGVzdChmaWxlLnBhdGgpKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEluY2x1ZGVkTm90ZXMoYWxsTm90ZXM6IFRGaWxlW10sIGV4Y2x1ZGVkRmlsZVBhdGhzOiBzdHJpbmdbXSk6IFRGaWxlW10ge1xuICAgIGxldCBhbGxJbmNsdWRlZE5vdGVzOiBURmlsZVtdID0gW107XG4gICAgYWxsTm90ZXMuZm9yRWFjaCgobm90ZSkgPT4ge1xuICAgICAgICBpZiAoIWlzRXhjbHVkZWQobm90ZSwgZXhjbHVkZWRGaWxlUGF0aHMpKVxuICAgICAgICAgICAgYWxsSW5jbHVkZWROb3Rlcy5wdXNo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
